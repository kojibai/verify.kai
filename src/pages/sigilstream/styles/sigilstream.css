/* src/pages/sigilstream/styles/sigilstream.css
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   Sigil Stream ‚Äî Atlantean Priest-King ‚óá Sentient Feed
   v7.3.0 ‚Äî Refactor: canonical primitives restored + Holy Card scoped
   - Mobile-first ‚Ä¢ Overflow-safe ‚Ä¢ iOS safe-areas ‚Ä¢ Breath aura
   - Accent resolution: sigil tint ‚Üí chakra mapping ‚Üí default
   - data-weekday / data-chakra now driven by TSX (v7.3.0)
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

/* ========== 0) RESET / HARD GUARDS ============================ */
*,
*::before,
*::after{ box-sizing:border-box; }

html, body{
  width:100%;
  max-width:100%;
  overflow-x:hidden;
  height:auto;
}

:where(img, video, svg, canvas, iframe){
  display:block;
  max-width:100%;
  height:auto;
}

body{
  overscroll-behavior-x:none;
  overscroll-behavior-y:contain;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  text-rendering:optimizeLegibility;
}

/* ========== 1) TOKENS ========================================= */
:root{
  --phi: 1.61803398875;

  /* Base void */
  --bg: 10,14,22;
  --glass: 255,255,255;

  /* Ink */
  --ink: 236,241,251;
  --muted: 180,192,210;
  --gold-ink: 255,215,128;
  --ok: 88,255,174;
  --danger: 255,88,88;

  /* Type */
  --font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  /* Default chakra accent (fallback) */
  --chakra-r: 42;
  --chakra-g: 197;
  --chakra-b: 255;

  /* Optional per-sigil tint (set from TSX via style vars) */
  /* --sigil-r: 42; --sigil-g: 197; --sigil-b: 255; */
  /* Optional hue if computed */
  /* --sigil-hue: 180; */

  --alpha-card: .06;
  --alpha-border: .12;

  /* Breath timing (overridden by ticker if you want) */
  --pulse-dur: 5236ms;
  --pulse-offset: 0ms;

  /* Safe areas */
  --safe-left: max(12px, env(safe-area-inset-left, 0px));
  --safe-right:max(12px, env(safe-area-inset-right, 0px));
  --safe-top:  env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);

  /* Radii */
  --r-card: 18px;
  --r-pill: 999px;

  /* Shadows */
  --shadow-1: 0 10px 30px rgba(0,0,0,.28);
  --shadow-2: 0 18px 54px rgba(0,0,0,.34);
  --inset-1: inset 0 1px 0 rgba(255,255,255,.05);
  --inset-2: inset 0 0 0 1px rgba(255,255,255,.03);

  /* Text sizes */
  --fz-title: clamp(28px, 5.6vw, 36px);
  --fz-body: 15px;
  --fz-sub: 13.5px;

  /* Focus ring */
  --focus: rgba(255,255,255,.18);
  --focus2: rgba(255,255,255,.10);
}

/* Optional: smooth breath mantle variables */
@supports (background: paint(something)) or (offset: path("M0,0")){
  @property --sf-breath-scale { syntax:"<number>"; inherits:false; initial-value:0; }
  @property --sf-breath-hue   { syntax:"<angle>";  inherits:false; initial-value:0deg; }
}

/* ========== 2) BACKGROUND ===================================== */
body{
  color: rgb(var(--ink));
  font-family: var(--font-sans);
  background:
    radial-gradient(1200px 800px at 14% 8%, rgba(42,197,255,.10), transparent 60%),
    radial-gradient(900px 700px at 88% 16%, rgba(255,215,128,.10), transparent 58%),
    radial-gradient(1100px 900px at 50% 92%, rgba(88,255,174,.08), transparent 62%),
    linear-gradient(180deg, rgba(10,14,22,1), rgba(8,10,16,1));
  background-color: rgb(var(--bg));
}

::selection{
  background: rgba(255,255,255,.14);
  color: rgb(var(--ink));
}

*::-webkit-scrollbar{ height:10px; width:10px; }
*::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.08));
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
*::-webkit-scrollbar-track{ background: transparent; }

/* ========== 3) CORE SHELL (.sf) ================================ */
.sf{
  -webkit-tap-highlight-color:transparent;
  overscroll-behavior-y:contain;

  width:100%;
  max-width:100%;
  padding-left: var(--safe-left);
  padding-right: var(--safe-right);
  padding-top: max(6px, var(--safe-top));
  padding-bottom: calc(12px + var(--safe-bottom));

  position: relative;
  isolation: isolate;
  min-width:0;

  /* Accent resolution: sigil ‚Üí chakra ‚Üí default */
  --accent-r: var(--sigil-r, var(--chakra-r, 42));
  --accent-g: var(--sigil-g, var(--chakra-g, 197));
  --accent-b: var(--sigil-b, var(--chakra-b, 255));

  --accent: rgb(var(--accent-r), var(--accent-g), var(--accent-b));
  --accent-92: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .92);
  --accent-35: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .35);
  --accent-22: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .22);
  --accent-14: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .14);
  --accent-10: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .10);
  --accent-06: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .06);

  /* SigilPage-like vars */
  --crystal-accent: rgb(var(--accent-r), var(--accent-g), var(--accent-b));
  --crystal-hue: var(--sigil-hue, 180);

  /* Weekday hue overlay */
  --day-hue: 195;
  --day-aura: hsla(var(--day-hue), 95%, 65%, .08);

  background:
    radial-gradient(900px 520px at 20% -10%, var(--accent-10), transparent 62%),
    radial-gradient(820px 520px at 92% 2%, var(--day-aura), transparent 66%),
    radial-gradient(1000px 760px at 54% 115%, rgba(255,255,255,.04), transparent 62%);
  border-radius: 22px;
}

/* Soft noise */
.sf::before{
  content:"";
  position:absolute; inset:-2px;
  pointer-events:none;
  border-radius: 24px;
  background:
    radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.06), transparent 60%),
    radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,.045), transparent 60%),
    radial-gradient(1px 1px at 70% 40%, rgba(255,255,255,.04), transparent 60%),
    radial-gradient(1px 1px at 90% 70%, rgba(255,255,255,.035), transparent 60%);
  opacity: .45;
  mix-blend-mode: overlay;
  filter: blur(.2px);
}

/* Breath mantle */
.sf::after{
  content:"";
  position: fixed;
  inset: -12%;
  z-index: -1;
  pointer-events:none;
  background:
    radial-gradient(65% 55% at 50% calc(52% + (var(--sf-breath-scale,0)*2%)),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .18) 0%,
      transparent 62%),
    radial-gradient(85% 65% at 20% 20%,
      rgba(92,225,255,.10) 0%,
      transparent 70%),
    radial-gradient(85% 65% at 80% 80%,
      rgba(167,139,250,.08) 0%,
      transparent 70%);
  filter: blur(30px) saturate(calc(1.05 + (var(--sf-breath-scale,0)*.25)))
          hue-rotate(var(--sf-breath-hue, 0deg));
  opacity: calc(.18 + (var(--sf-breath-scale,0)*.16));
  transform: scale(calc(1 + (var(--sf-breath-scale,0)*.03))) translateY(calc((var(--sf-breath-scale,0))*-1.2%));
  animation: sf-mantle var(--pulse-dur) cubic-bezier(.33,.01,.24,1) infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes sf-mantle{
  0%   { --sf-breath-scale: 0;   --sf-breath-hue: 0deg; }
  50%  { --sf-breath-scale: .9;  --sf-breath-hue: 6deg; }
  100% { --sf-breath-scale: 0;   --sf-breath-hue: 0deg; }
}

/* ========== 4) TYPOGRAPHY / WRAP =============================== */
.mono, .sf-mono{ font-family: var(--font-mono); }
.sf input, .sf textarea{ font-size:16px; } /* prevent iOS zoom */

.sf :where(p, li, .sf-payload-core, .sf-caption, .sf-kai-label, .sf-hash, .sf-note, .feed-card__body){
  overflow-wrap: break-word;
  word-break: normal;
  line-break: auto;
  hyphens: none;
  min-width:0;
  text-wrap: pretty;
}

.sf a{
  color: rgba(255,255,255,.92);
  text-decoration: underline;
  text-underline-offset: 2px;
  opacity:.95;
  overflow-wrap:anywhere;
  word-break: break-word;
  line-break:anywhere;
  transition: opacity .12s ease, text-shadow .18s ease;
}
.sf a:hover{
  opacity:1;
  text-shadow: 0 0 14px rgba(var(--accent-r), var(--accent-g), var(--accent-b), .18);
}

:focus-visible{
  outline: 2px solid rgba(var(--accent-r), var(--accent-g), var(--accent-b), .45);
  outline-offset: 2px;
}

/* ========== 5) HEADER ========================================== */
.sf-topnav{
  display:flex;
  justify-content:flex-start;
}

.sf-back{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius: var(--r-pill);
  text-decoration:none;
  color: rgb(var(--ink));
  background: rgba(var(--glass), .06);
  border: 1px solid rgba(var(--glass), .16);
  box-shadow: var(--inset-1);
  font-weight: 700;
}

.sf-back:focus-visible{
  outline: 2px solid var(--focus);
  outline-offset: 2px;
}

.sf-head{
  padding-top: 10px;
  padding-bottom: 6px;
}
.sf-head h1{
  margin: 8px 0 6px;
  font-size: var(--fz-title);
  line-height: 1.05;
  letter-spacing: .2px;
  font-weight: 900;
  color: rgba(255,255,255,.92);
  text-shadow: 0 10px 36px rgba(0,0,0,.32);
}
.sf-sub{
  margin: 8px 0 0;
  font-size: var(--fz-sub);
  opacity: .9;
}
.sf-muted{ opacity:.75; }

/* ========== 6) PILLS / CHIPS =================================== */
.sf-pill, .sf-chip{
  display:inline-flex;
  align-items:center;
  min-height: 26px;
  padding: 6px 10px;
  border-radius: var(--r-pill);
  font-size: .86rem;
  letter-spacing: .01em;
  background: rgba(var(--glass), .06);
  border: 1px solid rgba(var(--glass), .12);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
  white-space: nowrap;
  max-width: 100%;
  min-width: 0;
  box-shadow: var(--inset-1);
}

.sf :where(.sf-tags, .sf-chip-row, .sf-pill-row){
  display:flex;
  flex-wrap:wrap;
  gap:.5rem;
  min-width:0;
}

.sf-pill--phikey{ color: rgb(var(--ok)); border-color: rgba(88,255,174,.35); }
.sf-pill--ksig{ color: rgb(var(--gold-ink)); border-color: rgba(255,215,128,.35); }

.sf .sf-key{
  display:inline-block;
  overflow-wrap:anywhere;
  word-break: break-all;
  line-break:anywhere;
  min-width:0;
}

/* ========== 7) ALERTS ========================================== */
.sf-warn{
  margin-top:.35rem;
  background: rgba(255,210,130,.08);
  border: 1px solid rgba(255,210,130,.25);
  padding: .5rem .6rem;
  border-radius: 10px;
  font-size: .92rem;
}
.sf-error{
  background: rgba(255,88,88,.08);
  border: 1px solid rgba(255,88,88,.25);
  padding: .6rem .65rem;
  border-radius: 12px;
  font-weight: 800;
}

/* ========== 8) BUTTONS ========================================= */
.sf-btn{
  appearance:none;
  border: 1px solid rgba(var(--glass), .16);
  background: linear-gradient(180deg, rgba(var(--glass), .07), rgba(var(--glass), .045));
  color: rgb(var(--ink));
  padding: 8px 12px;
  border-radius: 12px;
  font-weight: 800;
  cursor: pointer;
  transition: border-color .15s ease, transform .06s ease, background .15s ease, box-shadow .15s ease, filter .15s ease;
  box-shadow: 0 6px 20px rgba(0,0,0,.25), var(--inset-1);
  user-select:none;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}
.sf-btn:hover{
  border-color: rgba(var(--glass), .26);
  background: linear-gradient(180deg, rgba(var(--glass), .095), rgba(var(--glass), .055));
  filter: brightness(1.03);
}
.sf-btn:active{ transform: translateY(1px) scale(.995); }
.sf-btn[disabled]{ opacity:.6; cursor: default; }
.sf-btn--ghost{ background: transparent; border: 1px dashed rgba(var(--glass), .25); }

/* Mini utility (used in some URL rows) */
.sf .sf-btn.sf-btn--mini{
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1;
}

/* ========== 9) INPUTS ========================================== */
.sf-input, .sf-textarea{
  width:100%;
  color: rgb(var(--ink));
  background: rgba(var(--glass), .06);
  border: 1px solid rgba(var(--glass), .12);
  border-radius: 12px;
  padding: 10px 12px;
  outline:none;
  transition: border-color .15s ease, background .15s ease, box-shadow .15s ease;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
}
.sf-textarea{ resize: vertical; min-height: 80px; }
.sf-input:focus, .sf-textarea:focus{
  border-color: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .45);
  box-shadow: 0 0 0 3px rgba(var(--accent-r), var(--accent-g), var(--accent-b), .12);
  background: rgba(var(--glass), .085);
}
.sf-input--locked{ opacity:.9; background: rgba(var(--glass), .04); cursor:not-allowed; }

/* ========== 10) KAI STATUS (BREATH AURA) ======================= */
.kai-feed-status{
  background: rgba(var(--glass), .06);
  border: 1px solid rgba(var(--glass), .12);
  border-radius: 12px;
  box-shadow: 0 8px 28px rgba(0,0,0,.35), var(--inset-1);
  font-variant-numeric: tabular-nums;
  position: relative;
  isolation: isolate;
  overflow: visible;
  min-width: 0;
}
.kai-feed-status::after{
  content:"";
  position:absolute; inset:0;
  border-radius: 12px;
  pointer-events:none;
  box-shadow: 0 0 0 0 rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0);
  animation: kai-breathe var(--pulse-dur) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes kai-breathe{
  0%{ box-shadow: 0 0 0 0 rgba(var(--accent-r), var(--accent-g), var(--accent-b), .0); }
  50%{ box-shadow: 0 0 26px 0 rgba(var(--accent-r), var(--accent-g), var(--accent-b), .18); }
  100%{ box-shadow: 0 0 0 0 rgba(var(--accent-r), var(--accent-g), var(--accent-b), .0); }
}

/* ========== 11) BODY CONTENT (TEXT / MD / HTML / CODE) ========= */
.sf-text{
  margin-top: 10px;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
  opacity: .95;
}

.sf-code,
.sf-md pre,
.sf-html pre{
  margin-top: 12px;
  border-radius: 14px;
  padding: 12px;
  background: rgba(0,0,0,.36);
  border: 1px solid rgba(255,255,255,.10);
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  box-shadow: 0 10px 30px rgba(0,0,0,.22), inset 0 1px 0 rgba(255,255,255,.04);
}

.sf-code code,
.sf-md pre code,
.sf-html pre code{
  display:block;
  white-space: pre;
  overflow-wrap: normal;
  font-size: 12px;
  line-height: 1.5;
  font-family: var(--font-mono);
  color: rgba(255,255,255,.92);
  tab-size: 2;
}

.sf-md code,
.sf-html code{
  font-family: var(--font-mono);
  font-size: 12px;
  padding: 1px 6px;
  border-radius: 9px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
}

.sf :where(.sf-md table, .sf-html table){
  width:100%;
  border-collapse: collapse;
  border-radius: 14px;
  overflow:hidden;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.03);
}
.sf :where(.sf-md th, .sf-html th),
.sf :where(.sf-md td, .sf-html td){
  padding: 10px 10px;
  border-bottom: 1px solid rgba(255,255,255,.08);
  vertical-align: top;
}
.sf :where(.sf-md th, .sf-html th){
  text-align:left;
  font-weight: 900;
  letter-spacing:.01em;
  background: rgba(255,255,255,.04);
}
.sf :where(.sf-md tr:last-child td, .sf-html tr:last-child td){ border-bottom:0; }

.sf :where(.sf-md blockquote, .sf-html blockquote){
  margin: 10px 0;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(var(--accent-r), var(--accent-g), var(--accent-b), .20);
  background:
    radial-gradient(520px 220px at 10% 0%, rgba(var(--accent-r), var(--accent-g), var(--accent-b), .10), transparent 60%),
    rgba(255,255,255,.03);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
  color: rgba(255,255,255,.90);
}
.sf :where(.sf-md hr, .sf-html hr){
  border:0;
  height:1px;
  margin: 12px 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.14), transparent);
}
/* ========== 12) CANONICAL EMBED / MEDIA PRIMITIVES (ATLANTEAN GLASS) =====
   Drop-in replacement for section 12 ONLY.
   - Same classnames (.sf-embed, .sf-media, modifiers) ‚úÖ
   - Breath-synced living glass using --pulse-dur / --pulse-offset ‚úÖ
   - Safe: no layout shifts, no overflow bleed, iOS-friendly ‚úÖ
============================================================================ */

/* ---------- Canonical iframe embed behavior (global) ---------- */
.sf-embed{
  position: relative;
  width: 100%;
  aspect-ratio: 16/9;
  min-width: 0;
  overflow: hidden;
  isolation: isolate;
  transform: translateZ(0);
  backface-visibility: hidden;

  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.12);

  /* Atlantean glass: depth + aura + day hue */
  background:
    radial-gradient(900px 320px at 14% 6%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .16),
      transparent 60%),
    radial-gradient(720px 280px at 88% 10%,
      hsla(var(--day-hue,195), 92%, 62%, .10),
      transparent 62%),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
    rgba(0,0,0,.22);

  box-shadow:
    0 18px 60px rgba(0,0,0,.34),
    inset 0 1px 0 rgba(255,255,255,.08),
    inset 0 0 0 1px rgba(255,255,255,.04);
}

/* Crystal rim ring */
.sf-embed::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: 18px;
  pointer-events:none;

  background:
    conic-gradient(from 180deg,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.00),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.20),
      rgba(255,215,128,.16),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.18),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.00));

  opacity: .55;

  /* ring cutout */
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  padding: 1px;
  -webkit-mask-composite: xor;
  mask-composite: exclude;

  animation: sf-embed-spin calc(var(--pulse-dur) * 6) linear infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes sf-embed-spin{ to{ transform: rotate(360deg); } }

/* Living sheen + subtle scanlines */
.sf-embed::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;

  background:
    linear-gradient(120deg,
      transparent 0%,
      rgba(255,255,255,.10) 20%,
      rgba(255,255,255,.06) 48%,
      transparent 78%),
    radial-gradient(520px 140px at 30% 10%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .22),
      transparent 70%),
    repeating-linear-gradient(
      180deg,
      rgba(255,255,255,.024) 0px,
      rgba(255,255,255,.024) 1px,
      transparent 1px,
      transparent 7px
    );

  mix-blend-mode: screen;
  opacity: .42;
  filter: blur(8px);
  transform: translateX(-38%);

  animation: sf-embed-shimmer var(--pulse-dur) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes sf-embed-shimmer{
  0%   { transform: translateX(-38%); opacity:.28; }
  45%  { opacity:.50; }
  50%  { transform: translateX(38%);  opacity:.66; }
  100% { transform: translateX(-38%); opacity:.28; }
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))){
  .sf-embed{
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
  }
}

/* Frame fits perfectly, stays crisp */
.sf-embed iframe,
.sf-embed__frame{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: 0;
  display: block;
  background: transparent;
  transform: translateZ(0);
}

/* Aspect variants */
.sf-embed--doc{ aspect-ratio: 4/3; }
.sf-embed--tall{ aspect-ratio: 10/16; }

/* ---------- Canonical media behavior (global) ---------- */
.sf-media{
  position: relative;
  width: 100%;
  min-width: 0;
  overflow: hidden;
  isolation: isolate;
  transform: translateZ(0);

  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.12);

  background:
    radial-gradient(900px 320px at 14% 6%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .14),
      transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)),
    rgba(0,0,0,.26);

  box-shadow:
    0 18px 60px rgba(0,0,0,.34),
    inset 0 1px 0 rgba(255,255,255,.07);
}

/* Rim + sheen for media too (lighter) */
.sf-media::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: 18px;
  pointer-events:none;
  background:
    radial-gradient(520px 140px at 25% 0%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .22),
      transparent 70%);
  opacity:.38;
  filter: blur(10px);
}
.sf-media::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    linear-gradient(120deg,
      transparent 0%,
      rgba(255,255,255,.09) 22%,
      rgba(255,255,255,.05) 50%,
      transparent 78%);
  mix-blend-mode: screen;
  opacity: .34;
  filter: blur(10px);
  transform: translateX(-34%);
  animation: sf-media-sheen calc(var(--pulse-dur) * 1.5) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes sf-media-sheen{
  0%   { transform: translateX(-34%); opacity:.22; }
  50%  { transform: translateX(34%);  opacity:.44; }
  100% { transform: translateX(-34%); opacity:.22; }
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))){
  .sf-media{
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
  }
}

/* Image */
.sf-media--image{
  display:grid;
  place-items:center;
}
.sf-media--image img{
  width:100%;
  height:auto;
  display:block;
  border-radius: 14px;
  box-shadow: 0 18px 52px rgba(0,0,0,.32);
  -webkit-user-drag: none;
}

/* Video */
.sf-media--video video{
  width:100%;
  height:auto;
  display:block;
  border-radius: 14px;
  background:#000;
  box-shadow: 0 18px 52px rgba(0,0,0,.32);
}

/* Audio */
.sf-media--audio{
  padding: 12px;
}
.sf-media--audio audio{
  width:100%;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .sf-embed::before,
  .sf-embed::after,
  .sf-media::after{
    animation: none !important;
  }
}


/* ========== 13) FAVICON (shared) =============================== */
.sf-favicon{
  width: 22px;
  height: 22px;
  border-radius: 7px;
  flex: 0 0 auto;
  background:
    radial-gradient(18px 18px at 30% 30%, rgba(255,255,255,.22), rgba(255,255,255,.06)),
    rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 24px rgba(0,0,0,.22), inset 0 1px 0 rgba(255,255,255,.06);
  overflow:hidden;
  display:grid;
  place-items:center;
}
.sf-favicon img{
  width:100%;
  height:100%;
  object-fit: cover;
  -webkit-user-drag:none;
}
.sf-favicon--blank{
  width: 22px;
  height: 22px;
  border-radius: 7px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
}

/* ========== 14) LINKCARDS (stream list) ======================== */
.sf-rlist{ display:grid; gap: 12px; }
.sf-rlist__item{ min-width:0; }

.sf-linkcard{
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(720px 280px at 12% 0%, rgba(var(--accent-r), var(--accent-g), var(--accent-b), .12), transparent 60%),
    linear-gradient(180deg, rgba(12,16,24,.70), rgba(10,14,22,.56));
  box-shadow: 0 16px 46px rgba(0,0,0,.30), inset 0 1px 0 rgba(255,255,255,.05);
  overflow:hidden;
  min-width:0;
  position: relative;
  isolation:isolate;
}
.sf-linkcard__head{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap: 12px;
  padding: 12px;
  min-width:0;
}
.sf-linkcard__brand{
  display:flex;
  gap: 10px;
  align-items:flex-start;
  min-width:0;
}
.sf-linkcard__brandText{ min-width:0; }
.sf-linkcard__title{
  font-weight: 900;
  font-size: 15px;
  line-height: 1.2;
  color: rgba(255,255,255,.92);
  overflow:hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.sf-linkcard__sub{
  margin-top: 4px;
  font-size: 12.5px;
  opacity: .85;
  min-width:0;
}
.sf-linkcard__host{
  font-weight: 900;
  opacity: .92;
}
.sf-linkcard__url{
  font-family: var(--font-mono);
  opacity: .90;
  overflow:hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display:inline-block;
  max-width: 100%;
  vertical-align: bottom;
}
.sf-linkcard__actions{
  display:flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content:flex-end;
  flex: 0 0 auto;
}
.sf-linkcard__desc{
  padding: 0 12px 12px;
  opacity: .90;
  font-size: 13.5px;
  line-height: 1.4;
}
.sf-linkcard__thumb{
  padding: 0 12px 12px;
}
.sf-linkcard__thumbImg{
  width:100%;
  height:auto;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.03);
  display:block;
}
.sf-linkcard__embed{
  padding: 0 12px 12px;
}

/* ========== 15) PAYLOAD SURFACE ================================ */
.sf-payload{
  margin-top:.5rem;
  padding:.75rem 14px;
  background: linear-gradient(180deg, rgba(12,16,24,.70), rgba(10,14,22,.60));
  border: 1px solid rgba(var(--glass), .12);
  border-radius: 12px;
  box-shadow: 0 8px 26px rgba(0,0,0,.35), var(--inset-1);
  overflow: visible;
  min-width:0;
}
.sf-payload-line{ display:flex; flex-wrap:wrap; gap:.4rem; margin-bottom:.35rem; min-width:0; }
.sf-payload-core{ font-size: .98rem; line-height: 1.35; }

/* ========== 16) KOPY BUTTON (canonical) ======================== */
.sf-kopyBtn{
  width: 100%;
  height: 56px;
  border-radius: 999px;
  border: 1px solid rgba(var(--accent-r), var(--accent-g), var(--accent-b), .55);
  background:
    linear-gradient(180deg,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .20),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .12)
    ),
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  color: rgba(255,255,255,.92);
  font-weight: 900;
  font-size: 16px;
  letter-spacing: .28em;
  cursor: pointer;
  box-shadow: 0 16px 44px rgba(0,0,0,.26), inset 0 0 0 1px rgba(255,255,255,.12);
  transition: transform .08s ease, filter .18s ease, border-color .18s ease, box-shadow .18s ease, background .18s ease;
  position: relative;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}
.sf-kopyBtn::after{
  content:"";
  position:absolute; inset:-2px;
  pointer-events:none;
  border-radius: 999px;
  background:
    radial-gradient(420px 120px at 30% 10%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .30),
      transparent 70%);
  opacity: .9;
  filter: blur(8px);
  transform: translateX(-18%);
  animation: kopy-sheen calc(var(--pulse-dur) * 2) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes kopy-sheen{
  0%{ transform: translateX(-22%); opacity: .55; }
  50%{ transform: translateX(18%); opacity: .95; }
  100%{ transform: translateX(-22%); opacity: .55; }
}
.sf-kopyBtn:hover{
  filter: brightness(1.05);
  border-color: rgba(var(--accent-r), var(--accent-g), var(--accent-b), .72);
  box-shadow: 0 18px 52px rgba(0,0,0,.30), inset 0 0 0 1px rgba(255,255,255,.14);
}
.sf-kopyBtn:active{ transform: translateY(1px) scale(.995); }
.sf-kopyBtn[disabled]{ opacity: .62; cursor: default; }

.sf-kopyBtn[data-state="copied"]{
  border-color: rgba(var(--ok), .60);
  background:
    linear-gradient(180deg, rgba(var(--ok), .22), rgba(var(--ok), .10)),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
}
.sf-kopyBtn[data-state="copied"]::after{
  animation: copied-pulse var(--pulse-dur) ease-in-out 1;
}
@keyframes copied-pulse{
  0%{ opacity:.35; transform: translateX(-10%) scale(1); }
  35%{ opacity:1; transform: translateX(10%) scale(1.02); }
  100%{ opacity:.45; transform: translateX(-10%) scale(1); }
}

/* ========== 17) REPLY COMPOSER ================================ */
.sf-reply{ margin-top: 1rem; overflow: visible; min-width:0; }
.sf-reply-title{ font-size: 1.15rem; margin: 0 0 .4rem; }
.sf-reply-actions{ margin-top: .6rem; display:flex; gap: .6rem; flex-wrap: wrap; }
.sf-reply-login{ margin-top: .5rem; }
.sf-inhaler .sf-reply-actions{ display:flex; gap:.5rem; flex-wrap:wrap; }

/* ========== 18) ATTACHMENTS (Holy Card) ‚Äî SCOPED =============== */
.sf-attachments{ margin-top: 14px; }
.sf-att-title{
  font-size: 12px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  opacity: 0.85;
  margin: 0 0 10px 2px;
}
.sf-att-grid{
  display:grid;
  grid-template-columns: 1fr;
  gap: 12px;
  width: 100%;
  max-width: 100%;
  min-width:0;
}
.sf-att-item{ width: 100%; max-width: 100%; min-width: 0; }

/* Card */
.sf-att-card{
  position: relative;
  width: 100%;
  max-width: 100%;
  min-width: 0;
  border-radius: 18px;
  overflow: hidden;
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 16px 40px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  contain: paint;
  isolation: isolate;
  backface-visibility: hidden;
}
.sf-att-card::before{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius: 20px;
  pointer-events:none;
  background:
    radial-gradient(1200px 240px at 20% -10%, rgba(255,215,120,0.18), transparent 55%),
    radial-gradient(900px 220px at 90% 0%, rgba(140,220,255,0.16), transparent 60%),
    radial-gradient(800px 260px at 60% 110%, rgba(180,140,255,0.14), transparent 60%);
  animation: sf-breath-aura var(--pulse-dur) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
  opacity: 0.65;
  filter: blur(0.3px);
  will-change: opacity, filter;
}
@keyframes sf-breath-aura{
  0%,100%{ opacity:.50; filter: blur(.2px); }
  50%{ opacity:.90; filter: blur(1.1px); }
}
.sf-att-card::after{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background:
    linear-gradient(120deg,
      transparent 0%,
      rgba(255,255,255,0.12) 22%,
      rgba(255,255,255,0.08) 50%,
      transparent 78%);
  transform: translateX(-38%);
  animation: sf-breath-shimmer var(--pulse-dur) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
  mix-blend-mode: screen;
  opacity: 0.5;
  will-change: transform, opacity, filter;
  filter: brightness(0.95);
}
@keyframes sf-breath-shimmer{
  0%{ transform: translateX(-38%); opacity:.30; filter: brightness(.9); }
  25%{ opacity:.55; filter: brightness(1.05); }
  50%{ transform: translateX(38%); opacity:.70; filter: brightness(1.15); }
  75%{ opacity:.55; filter: brightness(1.05); }
  100%{ transform: translateX(-38%); opacity:.30; filter: brightness(.9); }
}

/* Header hit area */
.sf-att-head{ position: relative; padding: 12px 12px 10px; }
.sf-att-head__hit{
  display: grid;
  grid-template-columns: 22px 1fr auto;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  color: inherit;
  padding: 10px 10px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.16);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), 0 10px 20px rgba(0,0,0,0.22);
  transition: transform 160ms ease, border-color 160ms ease, background 160ms ease, box-shadow 160ms ease;
}
.sf-att-head__hit:hover{
  transform: translateY(-1px);
  border-color: rgba(255,255,255,0.16);
  background: rgba(0,0,0,0.22);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.07), 0 14px 28px rgba(0,0,0,0.28);
}
.sf-att-head__hit:active{ transform: translateY(0px) scale(0.995); }
.sf-att-head__hit:focus-visible{
  outline: 2px solid rgba(255,215,120,0.55);
  outline-offset: 2px;
}
.sf-att-head__text{ min-width:0; }
.sf-att-head__title{
  font-size: 14px;
  line-height: 1.2;
  font-weight: 800;
  letter-spacing: 0.01em;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  text-shadow: 0 1px 0 rgba(0,0,0,0.45), 0 10px 22px rgba(0,0,0,0.35);
}
.sf-att-open{
  font-size: 12px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.75;
  padding-left: 8px;
  white-space: nowrap;
  color: rgba(255, 230, 170, 0.95);
  text-shadow: 0 1px 0 rgba(0,0,0,0.35), 0 12px 24px rgba(0,0,0,0.35);
}

/* Body */
.sf-att-body{ padding: 0 12px 12px; }

/* IMPORTANT: Holy Card only ‚Äúpolishes‚Äù primitives; it does NOT redefine geometry */
.sf-att-card .sf-embed{
  border-radius: 16px;
  box-shadow: 0 18px 44px rgba(0,0,0,0.32), inset 0 1px 0 rgba(255,255,255,0.06);
}
.sf-att-card .sf-media{
  border-radius: 16px;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.28);
  box-shadow: 0 18px 44px rgba(0,0,0,0.32), inset 0 1px 0 rgba(255,255,255,0.06);
}

/* tighten spacing when card is link-only */
.sf-att-card > .sf-att-head:last-child{ padding-bottom: 12px; }
/* ========== 17A) REPLY CONTEXT (previous message preview) ====== */

.sf-reply-context {
  margin-bottom: 0.75rem;
  padding: 0.75rem 0.9rem;
  border-radius: 12px;
  background:
    radial-gradient(520px 220px at 10% 0%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.18),
      transparent 60%),
    rgba(0, 0, 0, 0.55);
  border: 1px solid rgba(var(--glass), 0.16);
  box-shadow: 0 10px 26px rgba(0, 0, 0, 0.40), var(--inset-1);
  position: relative;
  overflow: hidden;
  min-width: 0;
}

/* Soft bottom fade so the clamp feels natural */
.sf-reply-context::after {
  content: "";
  position: absolute;
  inset: auto 0 0 0;
  height: 32px;
  pointer-events: none;
  background: linear-gradient(
    to bottom,
    rgba(10, 14, 22, 0) 0%,
    rgba(10, 14, 22, 0.72) 60%,
    rgba(10, 14, 22, 0.96) 100%
  );
}

/* Header row: pill + author */
.sf-reply-context-header {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.4rem;
  min-width: 0;
}

.sf-reply-context-author {
  font-size: 0.78rem;
  text-transform: uppercase;
  letter-spacing: 0.14em;
  opacity: 0.8;
}

/* Body: clamp to 3‚Äì4 lines, never let links make it 3 screens tall */
.sf-reply-context-body {
  font-size: 0.86rem;
  line-height: 1.4;
  opacity: 0.95;
  min-width: 0;

  /* Line clamp */
  display: -webkit-box;
  -webkit-line-clamp: 4;       /* üëà adjust if you want more/less height */
  -webkit-box-orient: vertical;
  overflow: hidden;

  /* Long URLs: break smart, but not one-char per line */
  word-break: break-word;
  overflow-wrap: break-word;
}

/* If the previous message actually contains link text, keep it inline + ellipsized */
.sf-reply-context-body a {
  color: rgba(255, 255, 255, 0.95);
  text-decoration: underline;
  text-underline-offset: 2px;
  max-width: 100%;
  display: inline-block;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ========== 19) STREAM LIST / EMPTY ============================ */
.sf-list{ margin: 1rem 0; display:grid; gap: .75rem; min-width:0; }

.sf-empty{
  padding: .85rem .95rem;
  border: 1px dashed rgba(var(--glass), .16);
  border-radius: 12px;
  opacity: .9;
  background: rgba(255,255,255,.02);
}

/* Composer: context stack */
.sf-reply-contextStack {
  display: grid;
  gap: 10px;
  margin: 0 0 14px 0;
}

.sf-reply-context {
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 14px;
  padding: 12px 12px 10px;
  background: rgba(255,255,255,0.04);
  box-shadow: 0 10px 30px rgba(0,0,0,0.18);
}

.sf-reply-context[data-depth="0"] {
  background: rgba(255,255,255,0.055);
  border-color: rgba(255,255,255,0.14);
}

.sf-reply-context-header {
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: space-between;
}

.sf-reply-context-author {
  opacity: 0.85;
  font-size: 0.92rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.sf-reply-context-body {
  margin: 8px 0 0 0;
  opacity: 0.9;
  line-height: 1.35;
}

/* Small "Open ‚Üí" inside context cards */
.sf-reply-context-open {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.9rem;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: inherit;
}

.sf-reply-context-open:hover {
  background: rgba(255,255,255,0.10);
  border-color: rgba(255,255,255,0.22);
}

/* Result: make Open look like a real button */
.sf-btn--open {
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.10);
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 40px;
  padding: 0 14px;
  border-radius: 12px;
  font-weight: 700;
}

.sf-btn--open:hover {
  background: rgba(255,255,255,0.14);
  border-color: rgba(255,255,255,0.26);
}

.sf-btn--open:active {
  transform: translateY(1px);
}

/* ========== 20) SIGIL STAGE (ATLANTEAN STAGE ‚Äî SUPER ADVANCED) ============
   Drop-in replacement for section 20 ONLY.
   - Same selectors (.sf-sigilWrap, ::before, __inner, svg guards) ‚úÖ
   - Breath-synced ‚Äúliving crystal‚Äù w/ rim, shimmer, depth, scanlines ‚úÖ
   - Does NOT break icon SVG sizing ‚úÖ
============================================================================ */

.sf-sigilWrap{
  margin-top: 14px;
  min-width: 0;
  position: relative;
  overflow: hidden;
  isolation: isolate;
  transform: translateZ(0);
  backface-visibility: hidden;

  border-radius: var(--r-card);
  border: 1px solid rgba(var(--glass), .14);

  /* Crystal slab: accent + weekday hue + deep void */
  background:
    radial-gradient(980px 520px at 18% 0%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .18),
      transparent 62%),
    radial-gradient(780px 520px at 88% 8%,
      hsla(var(--day-hue,195), 92%, 64%, .12),
      transparent 64%),
    radial-gradient(1100px 760px at 52% 120%,
      rgba(255,255,255,.05),
      transparent 62%),
    linear-gradient(180deg, rgba(12,16,24,.74), rgba(8,10,16,.62));

  box-shadow:
    0 22px 70px rgba(0,0,0,.40),
    inset 0 1px 0 rgba(255,255,255,.08),
    inset 0 0 0 1px rgba(255,255,255,.04);
}

/* Outer rim ring (cut-out) + slow spin */
.sf-sigilWrap::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: calc(var(--r-card) + 1px);
  pointer-events:none;

  background:
    conic-gradient(from 180deg,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.00),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.22),
      rgba(255,215,128, .18),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.20),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.00));

  opacity: .70;

  /* ring-only */
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  padding: 1px;
  -webkit-mask-composite: xor;
  mask-composite: exclude;

  animation: sf-sigil-rim-spin calc(var(--pulse-dur) * 6) linear infinite;
  animation-delay: var(--pulse-offset);

  filter: saturate(1.05);
}
@keyframes sf-sigil-rim-spin{ to{ transform: rotate(360deg); } }

/* Inner ‚Äúliving glass‚Äù veil: shimmer + scanlines + star dust */
.sf-sigilWrap::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;

  background:
    /* moving sheen */
    linear-gradient(120deg,
      transparent 0%,
      rgba(255,255,255,.12) 22%,
      rgba(255,255,255,.07) 50%,
      transparent 78%),
    /* breath aura bloom */
    radial-gradient(720px 260px at 30% 10%,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .24),
      transparent 70%),
    radial-gradient(680px 240px at 85% 18%,
      hsla(var(--day-hue,195), 92%, 64%, .16),
      transparent 72%),
    /* micro scanlines */
    repeating-linear-gradient(
      180deg,
      rgba(255,255,255,.020) 0px,
      rgba(255,255,255,.020) 1px,
      transparent 1px,
      transparent 7px
    ),
    /* star dust */
    radial-gradient(1px 1px at 12% 22%, rgba(255,255,255,.10), transparent 60%),
    radial-gradient(1px 1px at 28% 78%, rgba(255,255,255,.08), transparent 60%),
    radial-gradient(1px 1px at 66% 34%, rgba(255,255,255,.07), transparent 60%),
    radial-gradient(1px 1px at 84% 64%, rgba(255,255,255,.06), transparent 60%);

  mix-blend-mode: screen;
  opacity: .46;
  filter: blur(10px);
  transform: translateX(-38%);

  animation: sf-sigil-veil var(--pulse-dur) ease-in-out infinite;
  animation-delay: var(--pulse-offset);
}
@keyframes sf-sigil-veil{
  0%   { transform: translateX(-38%); opacity:.30; }
  45%  { opacity:.48; }
  50%  { transform: translateX(38%);  opacity:.66; }
  100% { transform: translateX(-38%); opacity:.30; }
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))){
  .sf-sigilWrap{
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
  }
}

/* Inner content layout */
.sf-sigilWrap__inner{
  position: relative;
  padding: 14px;
  display: grid;
  gap: 12px;
  min-width: 0;
  z-index: 1; /* above veils */
}

/* Main sigil SVG big + centered, but don't blow up button icons */
.sf-sigilWrap :where(svg){
  display:block;
  width: min(520px, 100%);
  height:auto;
  margin: 0 auto;

  /* depth + ‚Äúsigil lift‚Äù */
  filter:
    drop-shadow(0 24px 70px rgba(0,0,0,.55))
    drop-shadow(0 8px 22px rgba(var(--accent-r), var(--accent-g), var(--accent-b), .14));
  transform: translateZ(0);
}

/* keep control icons normal */
.sf-sigilWrap :where(button svg, a svg){
  width: 1em;
  height: 1em;
  margin: 0;
  filter: none;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .sf-sigilWrap::before,
  .sf-sigilWrap::after{
    animation: none !important;
  }
}

/* ===== SEALED / LOCK SCREEN ===== */
.sf-pill--sealed{
  color: rgba(255,230,170,.95);
  border-color: rgba(255,215,128,.35);
}

.sf-seal{
  margin-top: 10px;
  padding: 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,215,128,.22);
  background:
    radial-gradient(820px 260px at 18% 0%, rgba(255,215,128,.10), transparent 60%),
    rgba(0,0,0,.14);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
}

.sf-seal__row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
}

.sf-seal__label{
  font-weight: 900;
  letter-spacing: .14em;
  text-transform: uppercase;
  font-size: 12px;
  color: rgba(255,230,170,.95);
}

.sf-seal__btn{
  appearance:none;
  border-radius: 999px;
  padding: 10px 14px;
  border: 1px solid rgba(var(--accent-r), var(--accent-g), var(--accent-b), .45);
  background:
    linear-gradient(180deg,
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .18),
      rgba(var(--accent-r), var(--accent-g), var(--accent-b), .10)
    ),
    rgba(255,255,255,.04);
  color: rgba(255,255,255,.92);
  font-weight: 900;
  letter-spacing: .12em;
  cursor: pointer;
  box-shadow: 0 12px 34px rgba(0,0,0,.28), inset 0 1px 0 rgba(255,255,255,.08);
}

.sf-seal__btn:active{ transform: translateY(1px); }
.sf-seal__btn[disabled]{ opacity:.6; cursor:not-allowed; }

.sf-seal__hint{
  margin-top: 8px;
  font-size: 13px;
  opacity: .88;
}

.sf-seal__gate{
  margin-top: 10px;
  padding: 12px;
  border-radius: 14px;
  border: 1px dashed rgba(255,255,255,.18);
  background: rgba(0,0,0,.18);
}

.sf-seal__login{
  margin-top: 10px;
}

.sf-seal__login :where(button){
  width: 100%;
}

/* ========== 21) URL TRUNCATION GUARD =========================== */
.sf a.sf-link{
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  min-width: 0;
}

/* ========== 22) CHAKRA MAPPING ================================= */
.sf[data-chakra="Root"], .sf.chakra-root{           --chakra-r: 255; --chakra-g: 88;  --chakra-b: 88;  }
.sf[data-chakra="Sacral"], .sf.chakra-sacral{       --chakra-r: 255; --chakra-g: 146; --chakra-b: 88;  }
.sf[data-chakra="Solar"], .sf.chakra-solar{         --chakra-r: 255; --chakra-g: 215; --chakra-b: 128; }
.sf[data-chakra="Heart"], .sf.chakra-heart{         --chakra-r: 88;  --chakra-g: 255; --chakra-b: 174; }
.sf[data-chakra="Throat"], .sf.chakra-throat{       --chakra-r: 42;  --chakra-g: 197; --chakra-b: 255; }
.sf[data-chakra="Third Eye"], .sf.chakra-third-eye{ --chakra-r: 164; --chakra-g: 126; --chakra-b: 255; }
.sf[data-chakra="Crown"], .sf.chakra-crown{         --chakra-r: 238; --chakra-g: 241; --chakra-b: 251; }

/* ========== 23) WEEKDAY MAPPING ================================ */
.sf[data-weekday="Solhara"], .sf.day-solhara{ --day-hue: 48;  }
.sf[data-weekday="Aquaris"], .sf.day-aquaris{ --day-hue: 198; }
.sf[data-weekday="Flamora"], .sf.day-flamora{ --day-hue: 18;  }
.sf[data-weekday="Verdari"], .sf.day-verdari{ --day-hue: 128; }
.sf[data-weekday="Sonari"],  .sf.day-sonari{  --day-hue: 270; }
.sf[data-weekday="Kaelith"], .sf.day-kaelith{ --day-hue: 205; }

/* ========== 24) MOBILE POLISH ================================== */
@media (max-width: 520px){
  .sf{ border-radius: 18px; }
  .sf-linkcard{ border-radius: 16px; }
  .sf-favicon{ width:20px; height:20px; border-radius:6px; }
  .sf-att-card{ border-radius: 16px; }
  .sf-att-head__hit{ border-radius: 13px; }
  .sf-att-head__title{ font-size: 13px; }
  .sf-att-open{ font-size: 11px; }
}

/* Coarse pointers: bigger tap targets */
@media (pointer: coarse){
  .sf-btn{ min-height: 48px; padding: 12px 14px; border-radius: 14px; }
}

/* ========== 25) REDUCED MOTION ================================= */
@media (prefers-reduced-motion: reduce){
  .kai-feed-status::after,
  .sf::after,
  .sf-kopyBtn::after,
  .sf-att-card::before,
  .sf-att-card::after,
  .sf-sigilWrap::before{
    animation: none !important;
  }
  *{ transition:none !important; }
}
