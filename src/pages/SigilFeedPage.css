/* src/pages/sigilstream/styles/sigilstream.css
   SigilStream — Memory Stream Shell (FULL)
   ✅ Fixes: payload getting cut off / only bottom scrolling
   Strategy:
     - .sf is ALWAYS the primary scroll container (100dvh)
     - .sf-head stays glassy; sticky only when viewport is tall enough
     - when sticky is enabled, .sf-head becomes internally scrollable (so payload/reply never get clipped)
     - on shorter/mobile viewports, sticky is disabled so the whole page scrolls as ONE surface
   Notes:
     - avoids duplicate/conflicting .sf/.sf-btn/.sf-error definitions from earlier drafts
     - keeps your palette + aurora/krystal look
*/

/* ────────────────────────────────────────────────────────────────
   0) Tokens
──────────────────────────────────────────────────────────────── */
:root {
  color-scheme: dark light;

  /* Palette (dark default) */
  --bg: #07090b;
  --bg-2: #0b0f14;
  --bg-3: #0f141a;

  --text: #e7edf3;
  --text-dim: #cbd6e2;
  --text-soft: #9fb0c4;

  /* Golds (φ) */
  --gold-1: #f6e27a;
  --gold-2: #ffdf8a;
  --gold-3: #ffd166;
  --gold-4: #f4c361;

  /* Auras */
  --aqua: #7dd3fc;
  --violet: #c4b5fd;
  --teal: #2dd4bf;

  /* Surfaces */
  --glass: rgba(255, 255, 255, 0.06);
  --glass-2: rgba(255, 255, 255, 0.08);
  --glass-3: rgba(255, 255, 255, 0.12);

  --stroke: rgba(255, 255, 255, 0.14);
  --stroke-soft: rgba(255, 255, 255, 0.10);

  /* Shadows */
  --shadow-1: 0 10px 30px rgba(0, 0, 0, 0.35);
  --shadow-2: 0 16px 44px rgba(0, 0, 0, 0.45);
  --shadow-glow: 0 0 0 1px rgba(255, 220, 130, 0.35),
    0 0 40px rgba(255, 220, 130, 0.12);

  /* Radii */
  --r-xs: 8px;
  --r-sm: 12px;
  --r-md: 16px;
  --r-lg: 20px;
  --r-xl: 28px;

  /* φ spacing */
  --φ: 1.61803398875;
  --space-1: 8px;
  --space-2: calc(var(--space-1) * var(--φ));
  --space-3: calc(var(--space-2) * var(--φ));
  --space-4: calc(var(--space-3) * var(--φ));

  /* Motion */
  --breath: 5.2360679s;
  --ease-breath: cubic-bezier(0.22, 0.61, 0.36, 1);
  --ease-snap: cubic-bezier(0.17, 0.84, 0.44, 1);
  --ease-phi: cubic-bezier(0.61803398875, 0, 0.38196601125, 1);

  /* Type */
  --h1: clamp(28px, 6.6vw, 44px);
  --h2: clamp(18px, 3.6vw, 26px);
  --p: clamp(14px, 2.9vw, 17px);

  /* Layout */
  --container: min(1100px, 100vw);
  --blur: 16px;

  /* Sigil tint defaults (overridden by data attrs or inline vars) */
  --sigil-tint-rgb: 120 190 255;
}

@media (prefers-color-scheme: light) {
  :root {
    --bg: #fbfcfe;
    --bg-2: #f5f7fb;
    --bg-3: #eef2f8;

    --text: #0d1117;
    --text-dim: #223046;
    --text-soft: #4a5668;

    --glass: rgba(0, 0, 0, 0.05);
    --glass-2: rgba(0, 0, 0, 0.07);
    --glass-3: rgba(0, 0, 0, 0.10);

    --stroke: rgba(0, 0, 0, 0.14);
    --stroke-soft: rgba(0, 0, 0, 0.10);

    --shadow-1: 0 10px 22px rgba(21, 31, 44, 0.10);
    --shadow-2: 0 18px 42px rgba(21, 31, 44, 0.16);
    --shadow-glow: 0 0 0 1px rgba(180, 120, 20, 0.18),
      0 0 38px rgba(240, 200, 120, 0.12);
  }
}

/* ────────────────────────────────────────────────────────────────
   1) Global hardening (overflow-proof)
──────────────────────────────────────────────────────────────── */
:where(*, *::before, *::after) {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  width: 100%;
  max-width: 100%;
  overflow-x: clip;
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--text);
}

img,
svg,
video,
canvas {
  max-width: 100%;
  height: auto;
  display: block;
}

pre,
code,
kbd,
samp {
  white-space: pre-wrap;
  word-break: break-word;
  overflow-wrap: anywhere;
}

a,
button {
  -webkit-tap-highlight-color: transparent;
}

:focus:not(:focus-visible) {
  outline: none;
}
:focus-visible {
  outline: 2px solid rgba(255, 214, 120, 0.55);
  outline-offset: 2px;
  border-radius: 10px;
}

/* ────────────────────────────────────────────────────────────────
   2) Main scroll container (THE FIX)
   ✅ .sf is the scroll surface, always full viewport.
   ✅ works even if body is overflow:hidden.
──────────────────────────────────────────────────────────────── */
.sf {
  /* If your app root doesn’t guarantee height, this does. */
  height: 100vh;
  height: 100dvh;
  min-height: 100vh;
  min-height: 100dvh;

  width: 100%;
  max-width: 100%;
  overflow-y: auto;
  overflow-x: clip;

  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  scrollbar-gutter: stable;

  /* center content while still letting the background fill */
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-3);

  padding:
    max(var(--space-3), env(safe-area-inset-top, 0px))
    max(var(--space-2), env(safe-area-inset-right, 0px))
    max(var(--space-4), env(safe-area-inset-bottom, 0px))
    max(var(--space-2), env(safe-area-inset-left, 0px));

  background:
    radial-gradient(1200px 700px at 15% -10%, rgba(255, 214, 130, 0.12), transparent 60%),
    radial-gradient(1000px 640px at 95% 10%, rgba(152, 222, 255, 0.10), transparent 60%),
    linear-gradient(180deg, var(--bg-2), var(--bg));

  animation: sf-breath-bg var(--breath) var(--ease-breath) infinite alternate;
}

@keyframes sf-breath-bg {
  0% { box-shadow: inset 0 0 0 0 rgba(255, 219, 128, 0.04); }
  100% { box-shadow: inset 0 0 120px 0 rgba(255, 219, 128, 0.10); }
}

@media (prefers-reduced-motion: reduce) {
  .sf { animation: none; }
}

/* Keep children from forcing overflow */
.sf > * { width: var(--container); max-width: 100%; min-width: 0; }

/* ────────────────────────────────────────────────────────────────
   3) Weekday + Chakra theming (data attrs)
──────────────────────────────────────────────────────────────── */
.sf[data-weekday="Solhara"]  { --sigil-tint-rgb: 255 196 120; }
.sf[data-weekday="Aquaris"]  { --sigil-tint-rgb: 120 190 255; }
.sf[data-weekday="Flamora"]  { --sigil-tint-rgb: 255 132 170; }
.sf[data-weekday="Verdari"]  { --sigil-tint-rgb: 120 255 196; }
.sf[data-weekday="Sonari"]   { --sigil-tint-rgb: 250 220 120; }
.sf[data-weekday="Kaelith"]  { --sigil-tint-rgb: 178 150 255; }

.sf[data-chakra="Root"]         { --sigil-tint-rgb: 255 92 92; }
.sf[data-chakra="Sacral"]       { --sigil-tint-rgb: 255 154 92; }
.sf[data-chakra="Solar"],
.sf[data-chakra="Solar Plexus"] { --sigil-tint-rgb: 255 230 92; }
.sf[data-chakra="Heart"]        { --sigil-tint-rgb: 92 255 170; }
.sf[data-chakra="Throat"]       { --sigil-tint-rgb: 92 200 255; }
.sf[data-chakra="Third Eye"]    { --sigil-tint-rgb: 148 120 255; }
.sf[data-chakra="Crown"],
.sf[data-chakra="Krown"]        { --sigil-tint-rgb: 210 200 255; }

/* ────────────────────────────────────────────────────────────────
   4) Header shell (KRYSTAL GLASS)
   ✅ FIX: sticky is conditional + header is scroll-safe when sticky is on.
──────────────────────────────────────────────────────────────── */
.sf-head {
  position: relative;
  z-index: 10;

  border-radius: calc(var(--r-xl) + 10px);
  border: 1px solid var(--stroke);
  box-shadow:
    0 18px 56px rgba(0,0,0,0.52),
    inset 0 1px 0 rgba(255,255,255,0.12);

  padding: clamp(14px, 3.2vw, 18px);
  overflow: clip;

  background:
    radial-gradient(120% 170% at 18% 0%,
      rgba(255,255,255,0.10),
      rgba(255,255,255,0.00) 64%),
    radial-gradient(160% 220% at 82% 120%,
      rgba(var(--sigil-tint-rgb), 0.16),
      rgba(255,255,255,0.00) 62%),
    linear-gradient(135deg,
      rgba(255,255,255,0.085),
      rgba(255,255,255,0.028));

  backdrop-filter: blur(18px) saturate(1.25);
  -webkit-backdrop-filter: blur(18px) saturate(1.25);

  display: grid;
  gap: var(--space-2);
}

/* aurora rim */
.sf-head::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  border-radius: inherit;
  background:
    linear-gradient(180deg,
      rgba(255,255,255,0.20),
      rgba(255,255,255,0.04) 32%,
      rgba(0,0,0,0.00) 72%),
    radial-gradient(140% 180% at 50% 0%,
      rgba(var(--sigil-tint-rgb), 0.22),
      rgba(255,255,255,0.00) 60%);
  mix-blend-mode: overlay;
  opacity: 0.55;
}

/* breath shimmer sheet */
.sf-head::before{
  content:"";
  position:absolute;
  inset:-2px;
  pointer-events:none;
  background:
    linear-gradient(115deg,
      rgba(255,255,255,0.00) 0%,
      rgba(255,255,255,0.13) 20%,
      rgba(255,255,255,0.00) 40%,
      rgba(var(--sigil-tint-rgb), 0.12) 62%,
      rgba(255,255,255,0.00) 86%);
  opacity: 0.40;
  transform: translate3d(-36%, 0, 0);
  animation: sf-head-shimmer var(--breath) linear infinite;
}
@keyframes sf-head-shimmer{
  0%   { transform: translate3d(-40%, 0, 0); }
  100% { transform: translate3d( 40%, 0, 0); }
}
@media (prefers-reduced-motion: reduce){
  .sf-head::before{ animation: none; }
}

/* Title */
.sf-head h1{
  margin: 0;
  line-height: 1.06;
  font-weight: 920;
  letter-spacing: 0.01em;
  font-size: var(--h1);

  background:
    linear-gradient(180deg,
      rgba(255,255,255,0.98),
      rgba(210,224,245,0.92));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;

  text-shadow:
    0 1px 0 rgba(0,0,0,0.22),
    0 10px 30px rgba(0,0,0,0.38);
  position: relative;
}

/* small flare */
.sf-head h1::after{
  content:"";
  position:absolute;
  left: -10px;
  top: 50%;
  width: 54px;
  height: 54px;
  transform: translateY(-50%);
  border-radius: 999px;
  background:
    radial-gradient(circle at 50% 50%,
      rgba(var(--sigil-tint-rgb), 0.24),
      rgba(255,255,255,0.00) 66%);
  opacity: 0.9;
  pointer-events: none;
}

/* ✅ Sticky behavior that DOESN’T clip payload:
   - enable sticky only on sufficiently tall viewports
   - when sticky is active, header gets a max-height and its own scroll (so payload/reply never cut off)
*/
@media (min-height: 860px) and (min-width: 520px) {
  .sf-head{
    position: sticky;
    top: 0;
    z-index: 20;

    /* critical: if header becomes taller than viewport, it can scroll */
    max-height: calc(100dvh - env(safe-area-inset-top, 0px) - var(--space-2));
    overflow-y: auto;
    overscroll-behavior: contain;
    scrollbar-gutter: stable;
  }
}

/* ✅ Mobile / short screens: disable sticky so the whole page scrolls as one surface */
@media (max-height: 859px), (max-width: 519px) {
  .sf-head{
    position: relative;
    top: auto;
    max-height: none;
    overflow: visible;
  }
}

/* iOS sticky safety */
@supports (-webkit-touch-callout: none){
  @media (min-height: 860px) and (min-width: 520px) {
    .sf-head{ top: env(safe-area-inset-top); }
  }
}

/* ────────────────────────────────────────────────────────────────
   5) Small text helpers used by TSX
──────────────────────────────────────────────────────────────── */
.sf-sub{
  margin: 0;
  font-size: var(--p);
  color: var(--text-soft);
  line-height: 1.55;
}

.sf code{
  background: rgba(255, 255, 255, 0.08);
  padding: 0.12rem 0.42rem;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 85%;
  color: var(--gold-2);
}

/* ────────────────────────────────────────────────────────────────
   6) KaiStatus (your existing card)
──────────────────────────────────────────────────────────────── */
.kai-feed-status {
  --dur: var(--breath);
  --offset: 0ms;
  --aqua2: rgba(154, 230, 255, 0.85);
  --gold2: rgba(255, 215, 128, 0.95);
  --ink2: rgba(236, 241, 251, 1);

  position: relative;
  isolation: isolate;
  overflow: clip;
  border-radius: 14px;
  padding: 12px 14px;
  color: var(--ink2);

  font-variant-numeric: tabular-nums;
  letter-spacing: 0.01em;

  background:
    radial-gradient(120% 180% at 12% -10%, rgba(154, 230, 255, 0.14), transparent 55%) padding-box,
    radial-gradient(130% 220% at 96% 120%, rgba(255, 215, 128, 0.12), transparent 45%) padding-box,
    linear-gradient(135deg, rgba(10, 14, 22, 0.86), rgba(12, 18, 28, 0.70)) padding-box;

  border: 1px solid rgba(255, 255, 255, 0.14);
  box-shadow:
    0 10px 30px rgba(0, 0, 0, 0.35),
    inset 0 1px 0 rgba(255, 255, 255, 0.06),
    inset 0 0 0 1px rgba(255, 255, 255, 0.06);

  backdrop-filter: blur(8px) saturate(110%);
  -webkit-backdrop-filter: blur(8px) saturate(110%);
}

.kai-feed-status::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  pointer-events: none;

  background:
    radial-gradient(120% 160% at 15% -10%, rgba(154, 230, 255, 0.22), transparent 60%),
    radial-gradient(120% 160% at 110% 110%, rgba(255, 215, 128, 0.20), transparent 52%),
    linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.02));

  box-shadow:
    0 0 0 1px rgba(255, 255, 255, 0.04) inset,
    0 0 32px rgba(154, 230, 255, 0.20) inset,
    0 0 42px rgba(255, 215, 128, 0.18) inset,
    0 12px 38px rgba(0, 0, 0, 0.35);

  transform: scale(0.996);
  filter: blur(6px);
  opacity: 0.70;

  animation: kai-breathe var(--dur) ease-in-out infinite;
  animation-delay: var(--offset);
}

.kai-feed-status::after {
  content: "";
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: 7px;
  height: 3px;
  border-radius: 999px;

  background: linear-gradient(90deg, var(--gold2), var(--aqua2));
  transform-origin: left center;
  transform: scaleX(0.0001);

  box-shadow:
    0 0 14px rgba(255, 215, 128, 0.45),
    0 0 22px rgba(154, 230, 255, 0.35);

  animation: kai-progress var(--dur) linear infinite;
  animation-delay: var(--offset);
  pointer-events: none;
}

@keyframes kai-breathe {
  0%   { opacity: 0.68; transform: scale(0.996); filter: blur(6px); }
  50%  { opacity: 0.95; transform: scale(1.004); filter: blur(12px); }
  100% { opacity: 0.68; transform: scale(0.996); filter: blur(6px); }
}
@keyframes kai-progress {
  0%     { transform: scaleX(0.0001); opacity: 0.98; }
  96%    { transform: scaleX(1);      opacity: 0.98; }
  99.5%  { transform: scaleX(1);      opacity: 0; }
  100%   { transform: scaleX(0.0001); opacity: 0; }
}
@media (prefers-reduced-motion: reduce) {
  .kai-feed-status::before,
  .kai-feed-status::after { animation: none; }
}

/* ────────────────────────────────────────────────────────────────
   7) Payload card (the one getting clipped before)
   ✅ no layout clipping, no accidental overflow, safe on sticky header.
──────────────────────────────────────────────────────────────── */
.sf-payload{
  position: relative;
  isolation: isolate;
  overflow: hidden;

  margin: 0;
  padding: 14px 14px 16px;

  border-radius: 22px;
  border: 1px solid var(--stroke);
  color: rgba(240, 246, 255, 0.96);

  background:
    radial-gradient(1200px 420px at 12% 10%, rgba(120, 220, 255, 0.14), transparent 62%),
    radial-gradient(900px 360px at 92% 22%, rgba(190, 140, 255, 0.12), transparent 58%),
    radial-gradient(1200px 500px at 60% 110%, rgba(90, 255, 200, 0.08), transparent 60%),
    linear-gradient(180deg, rgba(14, 18, 28, 0.70), rgba(10, 12, 18, 0.42));

  -webkit-backdrop-filter: blur(var(--blur)) saturate(1.2);
  backdrop-filter: blur(var(--blur)) saturate(1.2);

  box-shadow:
    0 18px 50px rgba(0,0,0,0.35),
    inset 0 1px 0 rgba(255,255,255,0.10),
    inset 0 -1px 0 rgba(255,255,255,0.06);
}

/* edge breathe shimmer (no rotation) */
.sf-payload::before{
  content:"";
  position:absolute;
  inset:-2px;
  z-index:-1;
  opacity: 0.75;
  filter: blur(14px);
  background:
    conic-gradient(
      from 240deg,
      rgba(140, 220, 255, 0.0),
      rgba(140, 220, 255, 0.38),
      rgba(200, 150, 255, 0.20),
      rgba(110, 255, 210, 0.26),
      rgba(140, 220, 255, 0.0)
    );
  background-size: 180% 180%;
  background-position: 20% 20%;
  will-change: transform, opacity, filter, background-position;
  animation: sf-edge-breathe var(--breath) var(--ease-phi) infinite;
}
@keyframes sf-edge-breathe{
  0%   { opacity: 0.52; transform: translate3d(-1.2%, -0.8%, 0) scale(1.015); filter: blur(15px); background-position: 18% 22%; }
  38%  { opacity: 0.78; transform: translate3d( 0.9%, -0.2%, 0) scale(1.045); filter: blur(13px); background-position: 54% 30%; }
  62%  { opacity: 0.66; transform: translate3d(-0.4%,  0.6%, 0) scale(1.030); filter: blur(14px); background-position: 36% 54%; }
  100% { opacity: 0.52; transform: translate3d(-1.2%, -0.8%, 0) scale(1.015); filter: blur(15px); background-position: 18% 22%; }
}

.sf-payload::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index: 0;
  opacity: 0.20;
  background:
    repeating-linear-gradient(90deg, rgba(255,255,255,0.08) 0 1px, transparent 1px 22px),
    repeating-linear-gradient(0deg, rgba(255,255,255,0.06) 0 1px, transparent 1px 18px),
    radial-gradient(700px 240px at 30% 40%, rgba(255,255,255,0.08), transparent 60%);
  mix-blend-mode: overlay;
  animation: sf-film-breathe calc(var(--breath) * 2.618) var(--ease-phi) infinite;
}
@keyframes sf-film-breathe{
  0%   { opacity: 0.16; transform: translate3d(0,0,0) scale(1); }
  38%  { opacity: 0.22; transform: translate3d(0.4%, -0.2%, 0) scale(1.01); }
  62%  { opacity: 0.18; transform: translate3d(-0.2%, 0.3%, 0) scale(1.005); }
  100% { opacity: 0.16; transform: translate3d(0,0,0) scale(1); }
}

.sf-payload > *{ position: relative; z-index: 1; }

.sf-payload-line{
  display:flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items:center;
  min-width: 0;
}

.sf-pill{
  position: relative;
  display:inline-flex;
  align-items:center;
  gap: 8px;

  padding: 7px 10px;
  border-radius: 999px;

  font-size: 11px;
  letter-spacing: 0.12em;
  text-transform: uppercase;

  color: rgba(240,246,255,0.94);
  border: 1px solid rgba(255,255,255,0.14);

  background:
    radial-gradient(140px 44px at 18% 30%, rgba(255,255,255,0.12), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.04));

  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);

  box-shadow:
    0 8px 22px rgba(0,0,0,0.25),
    inset 0 1px 0 rgba(255,255,255,0.10);

  max-width: 100%;
  overflow-wrap: anywhere;
}

.sf-pill--sealed { border-color: rgba(255, 160, 160, 0.35); }
.sf-pill--mode   { border-color: rgba(255, 220, 140, 0.25); }
.sf-pill--phikey { border-color: rgba(255, 220, 140, 0.20); }

.sf-key{
  font-variant-numeric: tabular-nums;
  letter-spacing: 0.02em;
  text-transform: none;
  opacity: 0.92;
}

.sf-payload-core{
  margin-top: 10px;
  line-height: 1.4;
  font-size: 14px;
  color: rgba(240,246,255,0.95);
  overflow-wrap: anywhere;
}

.sf-kai-label{
  color: rgba(205, 224, 248, 0.92);
  font-variant-numeric: tabular-nums;
}

/* Remember button (PayloadCard uses .sf-kopyBtn) */
.sf-reply-actions{
  margin-top: 12px;
  display:flex;
  gap: 10px;
  align-items:center;
  flex-wrap: wrap;
}

.sf-kopyBtn{
  appearance: none;
  border: 1px solid rgba(255,255,255,0.16);
  background:
    radial-gradient(220px 80px at 18% 30%, rgba(140,220,255,0.22), transparent 60%),
    radial-gradient(200px 70px at 82% 28%, rgba(200,150,255,0.18), transparent 58%),
    linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.05));
  color: rgba(245, 250, 255, 0.96);

  border-radius: 14px;
  padding: 10px 14px;
  min-height: 44px;

  font-weight: 900;
  letter-spacing: 0.10em;
  text-transform: uppercase;

  cursor: pointer;
  user-select: none;

  box-shadow:
    0 14px 30px rgba(0,0,0,0.35),
    inset 0 1px 0 rgba(255,255,255,0.12);

  transition:
    transform 0.15s var(--ease-snap),
    box-shadow 0.2s var(--ease-snap),
    border-color 0.2s var(--ease-snap),
    filter 0.2s var(--ease-snap);
}

.sf-kopyBtn:hover{
  transform: translateY(-1px);
  border-color: rgba(255,255,255,0.24);
  box-shadow: var(--shadow-2), inset 0 1px 0 rgba(255,255,255,0.12);
}

.sf-kopyBtn:active{ transform: translateY(0) scale(0.99); }
.sf-kopyBtn[disabled]{ opacity: 0.65; cursor: not-allowed; transform: none; }
.sf-kopyBtn[data-state="copied"]{
  border-color: rgba(255, 223, 138, 0.55);
  box-shadow: var(--shadow-glow);
  filter: saturate(1.05) brightness(1.02);
}

/* ────────────────────────────────────────────────────────────────
   8) Sealed (lock screen) styles (used by PayloadCard)
──────────────────────────────────────────────────────────────── */
.sf-seal{
  margin-top: 12px;
  padding: 12px;
  border-radius: var(--r-lg);
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.05);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
}

.sf-seal__row{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
}

.sf-seal__label{
  font-weight: 800;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 12px;
  opacity: 0.92;
}

.sf-seal__btn{
  appearance: none;
  border: 1px solid rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.06);
  color: rgba(245,250,255,0.96);
  border-radius: 12px;
  padding: 10px 12px;
  min-height: 42px;
  font-weight: 900;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
  transition: transform 0.15s var(--ease-snap), background 0.2s var(--ease-snap), border-color 0.2s var(--ease-snap);
}
.sf-seal__btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,0.22); background: rgba(255,255,255,0.08); }
.sf-seal__btn:active{ transform: translateY(0) scale(0.99); }
.sf-seal__btn[disabled]{ opacity: 0.6; cursor: not-allowed; transform: none; }

.sf-seal__hint{
  margin-top: 10px;
  font-size: 13px;
  line-height: 1.45;
  color: rgba(205, 224, 248, 0.92);
}

.sf-seal__gate{
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,0.10);
}

.sf-seal__login{
  margin-top: 8px;
  border-radius: var(--r-lg);
  border: 1px dashed rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.04);
  padding: 12px;
}

/* ────────────────────────────────────────────────────────────────
   9) Post body rendering styles (text / md / html / code)
──────────────────────────────────────────────────────────────── */
.sf-text{
  margin-top: 12px;
  color: rgba(240,246,255,0.92);
  font-size: var(--p);
  line-height: 1.6;
}

.sf-code{
  margin-top: 12px;
  border-radius: var(--r-lg);
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.22);
  padding: 12px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.06);
}
.sf-code code{
  color: rgba(255, 239, 199, 0.95);
  background: transparent;
  border: 0;
  padding: 0;
  font-size: 13px;
  line-height: 1.55;
}

.sf-md,
.sf-html{
  margin-top: 12px;
  border-radius: var(--r-lg);
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04);
  padding: 12px;
  overflow-wrap: anywhere;
}
.sf-md :where(h1,h2,h3,h4){ margin: 0.6em 0 0.35em; }
.sf-md p{ margin: 0.6em 0; line-height: 1.65; color: rgba(240,246,255,0.92); }
.sf-md a, .sf-html a{
  color: var(--gold-2);
  text-decoration: none;
  border-bottom: 1px solid rgba(255,223,138,0.35);
}
.sf-md a:hover, .sf-html a:hover{ border-bottom-color: rgba(255,223,138,0.65); }

/* ────────────────────────────────────────────────────────────────
   10) Reply composer shell
──────────────────────────────────────────────────────────────── */
.sf-reply {
  display: grid;
  gap: var(--space-2);
  padding: var(--space-3);
  border-radius: var(--r-xl);
  border: 1px solid var(--stroke);
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.02)) padding-box,
    radial-gradient(1200px 600px at 100% -20%, rgba(152, 222, 255, 0.16), transparent 70%) border-box;
  box-shadow: var(--shadow-1);
  overflow: visible;
}

@supports (backdrop-filter: blur(1px)) {
  .sf-reply { backdrop-filter: blur(var(--blur)); }
}

.sf-reply-title {
  font-size: var(--h2);
  margin: 0;
  letter-spacing: 0.2px;
  background: linear-gradient(92deg, var(--gold-2), var(--aqua));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.sf-reply-login{
  border: 1px dashed var(--stroke);
  border-radius: var(--r-lg);
  padding: calc(var(--space-2) * 1.2);
  background: var(--glass);
}

/* ────────────────────────────────────────────────────────────────
   11) Inhaler wrapper + Sigil stage wrapper
──────────────────────────────────────────────────────────────── */
.sf-inhaler{ margin-top: 6px; }

.sf-sigilWrap{
  margin-top: 10px;
  border-radius: var(--r-xl);
  border: 1px solid var(--stroke);
  background: rgba(255,255,255,0.04);
  box-shadow: var(--shadow-1);
  overflow: clip;
}
.sf-sigilWrap__inner{
  padding: 14px;
  display: grid;
  place-items: center;
}

/* ────────────────────────────────────────────────────────────────
   12) Feed list section (bottom)
   ✅ FIX: does NOT own scrolling; .sf owns scrolling.
──────────────────────────────────────────────────────────────── */
.sf-list{
  display: grid;
  gap: 0.9rem;
  padding-bottom: max(10px, env(safe-area-inset-bottom, 0px));
}

.sf-list .feed-card{
  border-radius: var(--r-xl);
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
  border: 1px solid var(--stroke);
  box-shadow: var(--shadow-1);
  position: relative;
  overflow: clip;
}

.sf-list .feed-card::after{
  content:"";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    radial-gradient(60% 40% at 10% -10%, rgba(255, 214, 120, 0.10), transparent 60%),
    radial-gradient(60% 40% at 100% 0%, rgba(152, 222, 255, 0.08), transparent 60%);
  opacity: 0.7;
}

/* Empty + error */
.sf-empty{
  border: 1px dashed var(--stroke);
  color: var(--text-soft);
  background: repeating-linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.03) 0 8px,
    rgba(255, 255, 255, 0.01) 8px 16px
  );
  padding: var(--space-3);
  border-radius: var(--r-lg);
  text-align: center;
}

.sf-error{
  border: 1px solid rgba(255, 120, 120, 0.35);
  background: linear-gradient(180deg, rgba(255, 80, 80, 0.12), rgba(255, 80, 80, 0.06));
  color: #ffd5d5;
  padding: 0.75rem 1rem;
  border-radius: var(--r-md);
}

/* ────────────────────────────────────────────────────────────────
   13) Responsive tightening
──────────────────────────────────────────────────────────────── */
@media (max-width: 820px) {
  .sf-head { padding: var(--space-2); }
  .sf-reply { padding: var(--space-2); }
  .sf-reply-actions,
  .sf-reply-actions > * { width: 100%; }
  .sf-kopyBtn { width: 100%; justify-content: center; }
}

@media (max-width: 420px) {
  .sf-payload { padding: 12px 12px 14px; border-radius: 20px; }
  .sf-pill { font-size: 10px; padding: 6px 9px; }
  .sf-payload-core { font-size: 13px; }
}

/* Contrast + Print */
@media (prefers-contrast: more) {
  .sf-head,
  .sf-payload,
  .sf-reply,
  .sf-list .feed-card {
    border-color: rgba(255, 255, 255, 0.45);
  }
}

@media print {
  .sf {
    height: auto;
    min-height: auto;
    overflow: visible;
    background: #fff;
    color: #000;
    animation: none;
  }
  .sf-head,
  .sf-payload,
  .sf-list .feed-card,
  .sf-reply {
    box-shadow: none;
    backdrop-filter: none;
    border: 1px solid #000;
  }
  .sf-inhaler,
  .sf-reply,
  .sf-empty,
  .sf-error {
    display: none;
  }
}
