:root{
  --kai-breath: 5.236s;
  --kai-phi: 1.61803398875;

  --sigil-fg: rgba(229,246,255,.95);
  --sigil-bg: rgba(255,255,255,.05);
  --sigil-brd: rgba(255,255,255,.15);

  --sigil-accent-a: #00ffd0;
  --sigil-accent-b: #8a2be2;
  --sigil-accent-c: #00b4ff;
}

/* Wrapper */
.sigil-login-only{
  padding: clamp(12px, 3vw, 18px);
  max-width: 640px;
  margin: 0 auto;
}

/* Dropzone */
.sigil-dropzone{
  position: relative;
  width: 100%;
  min-height: 260px;
  border-radius: 18px;
  border: 1px solid var(--sigil-brd);
  background: var(--sigil-bg);
  backdrop-filter: blur(6px) saturate(1.06);
  box-shadow: inset 0 0 0 1px rgba(0,255,208,.16);
  overflow: hidden; /* important: prevent any peeking */
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.sigil-dropzone--over{
  box-shadow: 0 0 0 3px rgba(0,255,208,.35);
  cursor: copy;
}

.sigil-dropzone--loading{
  opacity: .86;
  filter: saturate(.9);
  cursor: progress;
}

.sigil-dropzone--ok{
  border-color: rgba(16,185,129,.45);
  box-shadow:
    inset 0 0 0 1px rgba(16,185,129,.35),
    0 0 28px rgba(16,185,129,.18);
}

.sigil-dropzone--err{
  border-color: rgba(239,68,68,.5);
  box-shadow:
    inset 0 0 0 1px rgba(239,68,68,.35),
    0 0 28px rgba(239,68,68,.18);
}

.sigil-dropzone:focus-visible{
  outline: none;
  box-shadow:
    0 0 0 4px rgba(0,180,255,.35),
    0 0 0 6px rgba(0,255,208,.25);
}

/* Decorative */
.sigil-grid{
  position:absolute;
  inset:0;
  pointer-events:none;
  opacity:.22;
  mix-blend-mode: screen;
  background-image:
    linear-gradient(90deg, rgba(255,255,255,.08) 1px, transparent 1px),
    linear-gradient(0deg, rgba(255,255,255,.06) 1px, transparent 1px);
  background-size: calc(100% / var(--kai-phi)) 100%, 100% calc(100% / var(--kai-phi));
}

.sigil-ring{
  position:absolute;
  inset:0;
  border-radius: 18px;
  pointer-events:none;
}

.sigil-ring--outer{
  box-shadow:
    inset 0 0 0 1px rgba(0,255,208,.24),
    0 0 36px rgba(0,255,208,.22);
  animation: ring-breathe var(--kai-breath) ease-in-out infinite;
}

.sigil-ring--inner{
  inset: 12px;
  border-radius: 14px;
  box-shadow:
    inset 0 0 0 1px rgba(138,43,226,.26),
    inset 0 0 30px rgba(138,43,226,.22);
  animation: ring-breathe calc(var(--kai-breath) * 1.618) ease-in-out infinite reverse;
}

/* Center content */
.sigil-center{
  position: relative;
  z-index: 2;
  display: grid;
  place-items: center;
  text-align: center;
  gap: 10px;
  padding: clamp(22px, 4vw, 28px);
  min-height: clamp(260px, 34vh, 360px);
}

.sigil-instructions{
  font-size: clamp(14px, 1.1vw, 16px);
  font-weight: 800;
  letter-spacing: .02em;
  color: var(--sigil-fg);
  opacity:.95;
  text-wrap: balance;
}

.sigil-accent{
  background: linear-gradient(90deg,var(--sigil-accent-a),var(--sigil-accent-b));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 0 18px rgba(0,255,208,.18);
}

/* Orb */
.sigil-orb{
  width: clamp(88px, 18vw, 128px);
  height: clamp(88px, 18vw, 128px);
  border-radius: 9999px;
  display: grid;
  place-items: center;
  box-shadow:
    0 0 0 2px rgba(255,255,255,.14) inset,
    0 8px 28px rgba(0,0,0,.35);
  background:
    radial-gradient(55% 55% at 50% 50%, rgba(255,255,255,.12), rgba(255,255,255,.04));
  backdrop-filter: blur(4px);
}

.sigil-orb__core{
  width: 48%;
  height: 48%;
  border-radius: 9999px;
  background: radial-gradient(circle at 40% 40%, #fff, var(--sigil-accent-a));
  box-shadow:
    0 0 18px rgba(0,255,208,.45),
    0 0 28px rgba(0,180,255,.28);
  animation: orb-breathe var(--kai-breath) ease-in-out infinite;
}

/* Status */
.sigil-status{
  margin-top: 6px;
  min-height: 26px;
  color: rgba(255,255,255,.78);
}

.sigil-status__hint{
  opacity: .7;
}

.sigil-status__row,
.sigil-status__ok{
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.sigil-spinner{
  width: 16px;
  height: 16px;
  border-radius: 9999px;
  border: 2px solid rgba(255,255,255,.35);
  border-top-color: transparent;
  animation: sigil-spin 1s linear infinite;
}

.sigil-status__ok{ color: #34d399; }

.ok-dot{
  width: 8px;
  height: 8px;
  border-radius: 9999px;
  background: #34d399;
  box-shadow: 0 0 12px rgba(16,185,129,.4);
  animation: okpulse var(--kai-breath) ease-in-out infinite;
}

.sigil-status__err{
  display: inline-block;
  color: #fecaca;
  background: rgba(239,68,68,.12);
  border: 1px solid rgba(239,68,68,.35);
  border-radius: 10px;
  padding: 6px 10px;
}

/* ✅✅✅ HARD HIDE FILE INPUT (Safari/iOS-proof, Tailwind-proof, reset-proof) */
.sigil-file-input{
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  border: 0 !important;
  opacity: 0 !important;
  pointer-events: none !important;

  clip: rect(0,0,0,0) !important;
  clip-path: inset(50%) !important;
  white-space: nowrap !important;

  /* Defensive: prevent native control painting quirks */
  -webkit-appearance: none !important;
  appearance: none !important;
}

/* Animations */
@keyframes ring-breathe{
  0%{ opacity:.7; transform: scale(1) }
  50%{ opacity:1; transform: scale(1.012) }
  100%{ opacity:.7; transform: scale(1) }
}

@keyframes sigil-spin{ to { transform: rotate(360deg) } }

@keyframes orb-breathe{
  0%{ transform: scale(1); opacity:.82 }
  50%{ transform: scale(1.05); opacity:1 }
  100%{ transform: scale(1); opacity:.82 }
}

@keyframes okpulse{
  0%{ transform: scale(.96) }
  50%{ transform: scale(1.06) }
  100%{ transform: scale(.96) }
}

/* Small screens */
@media (max-width: 560px){
  .sigil-center{
    min-height: 260px;
    padding: 20px 14px;
  }
  .sigil-orb{
    width: clamp(80px, 28vw, 104px);
    height: clamp(80px, 28vw, 104px);
  }
}

/* Motion safety */
@media (prefers-reduced-motion: reduce){
  *{
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition: none !important;
  }
}
