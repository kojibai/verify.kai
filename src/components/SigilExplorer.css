/* src/pages/SigilExplorer.css
   Kairos Keystream Explorer — KRYSTAL ETCH v3 (Atlantean Glass)
   - Per-node chakra tint (root/sacral/solar/heart/throat/thirdEye/crown)
   - Etched refraction + caustic drift + micro-noise overlay
   - Breath motion (φ cadence) with reduced-motion compliance
   - Fully scoped to .sigil-explorer
*/

/* ─────────────────────────────────────────────────────────────
   ROOT / THEME TOKENS (scoped)
   ───────────────────────────────────────────────────────────── */
.sigil-explorer {
  /* Ink */
  --sx-text: #ecffff;
  --sx-text-dim: #a9f6ee;

  /* Atlantean triad */
  --sx-accent: #23fff0;
  --sx-accent-2: #b7a3ff;
  --sx-accent-3: #62daff;

  /* Chakra defaults (used if node doesn’t override --sx-chakra) */
  --sx-chakra: var(--sx-accent);

  /* Kai breath */
  --sx-breath: 5.236s;

  /* Mono */
  --sx-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  /* Background glass */
  --sx-bg: rgba(6, 10, 14, 0.76);
  --sx-bg-tint-top: rgba(14, 30, 36, 0.68);
  --sx-bg-tint-bot: rgba(6, 10, 14, 0.70);

  /* Borders / rings */
  --sx-border: rgba(35, 255, 240, 0.34);
  --sx-border-soft: rgba(255, 255, 255, 0.11);
  --sx-border-strong: rgba(35, 255, 240, 0.66);

  --sx-shadow: 0 30px 80px rgba(0, 0, 0, 0.55),
    inset 0 1px 0 rgba(255, 255, 255, 0.04);
  --sx-shadow-card: 0 18px 40px rgba(0, 0, 0, 0.55);

  --sx-ring: 0 0 0 2px rgba(35, 255, 240, 0.25),
    0 0 0 6px rgba(35, 255, 240, 0.12);

  --sx-radius: 18px;
  --sx-radius-sm: 12px;
  --sx-pad: clamp(10px, 3vw, 18px);
  --sx-maxw: 1100px;

  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial,
    "Apple Color Emoji", "Segoe UI Emoji";
  color: var(--sx-text);

  background:
    radial-gradient(1200px 800px at 50% -10%, rgba(0, 0, 0, 0.64), #000000a6 60%),
    radial-gradient(1200px 800px at 50% 20%, rgba(35, 255, 240, 0.13), transparent 60%),
    radial-gradient(800px 600px at 10% 90%, rgba(98, 218, 255, 0.12), transparent 60%),
    radial-gradient(900px 700px at 90% 80%, rgba(183, 163, 255, 0.12), transparent 60%),
    linear-gradient(180deg, var(--sx-bg-tint-top), var(--sx-bg-tint-bot));

  min-height: 100dvh;
  width: 100%;
  display: grid;
  grid-template-rows: auto 1fr;
  overflow: hidden;
  position: relative;
}

.sigil-explorer * { box-sizing: border-box; }

/* ─────────────────────────────────────────────────────────────
   GLOBAL KRYSTAL OVERLAY (etched + caustic drift)
   ───────────────────────────────────────────────────────────── */
.sigil-explorer::before,
.sigil-explorer::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.sigil-explorer::before{
  /* micro-noise + etch lines */
  background:
    repeating-linear-gradient(
      180deg,
      rgba(255,255,255,0.022) 0px,
      rgba(255,255,255,0.022) 1px,
      rgba(0,0,0,0.00) 3px,
      rgba(0,0,0,0.00) 7px
    ),
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,0.012) 0px,
      rgba(255,255,255,0.012) 1px,
      rgba(0,0,0,0.00) 5px,
      rgba(0,0,0,0.00) 11px
    );
  mix-blend-mode: overlay;
  opacity: .35;
}

.sigil-explorer::after{
  /* caustic aurora drift */
  background:
    radial-gradient(900px 600px at 30% 20%, rgba(35,255,240,0.10), transparent 60%),
    radial-gradient(800px 620px at 80% 70%, rgba(183,163,255,0.10), transparent 60%),
    radial-gradient(760px 560px at 15% 85%, rgba(98,218,255,0.08), transparent 62%);
  filter: blur(10px) saturate(1.05);
  opacity: .55;
  animation: sx-aurora var(--sx-breath) ease-in-out infinite;
}

@keyframes sx-aurora{
  0%   { transform: translate3d(0,0,0) scale(1); opacity:.48; }
  50%  { transform: translate3d(0,-10px,0) scale(1.03); opacity:.62; }
  100% { transform: translate3d(0,0,0) scale(1); opacity:.48; }
}

/* Ensure content sits above overlays */
.kx-toolbar,
.explorer-scroll { position: relative; z-index: 1; }

/* ─────────────────────────────────────────────────────────────
   STICKY TOOLBAR
   ───────────────────────────────────────────────────────────── */
.kx-toolbar{
  position: sticky;
  top: 0;
  z-index: 10;
  -webkit-backdrop-filter: blur(14px) saturate(140%);
  backdrop-filter: blur(14px) saturate(140%);
  background:
    linear-gradient(180deg, rgba(255, 255, 255, 0.07), rgba(255, 255, 255, 0.02)) border-box,
    linear-gradient(180deg, rgba(10, 18, 22, 0.82), rgba(6, 10, 14, 0.78));
  border-bottom: 1px solid rgba(255,255,255,0.10);
  box-shadow: var(--sx-shadow);
}

.kx-toolbar-inner{
  max-width: var(--sx-maxw);
  margin: 0 auto;
  padding: var(--sx-pad);
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
}

@media (min-width: 860px){
  .kx-toolbar-inner{
    grid-template-columns: 1fr auto;
    align-items: center;
  }
}

/* Brand */
.kx-brand{
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: 12px;
  min-width: 0;
}

.kx-glyph{
  width: 40px;
  height: 40px;
  border-radius: 12px;
  background:
    radial-gradient(120% 120% at 50% 0%, rgba(55,255,228,0.35), rgba(255,255,255,0) 62%),
    conic-gradient(
      from 220deg,
      rgba(55,255,228,0.10),
      rgba(92,225,255,0.10),
      rgba(167,139,250,0.12),
      rgba(55,255,228,0.10)
    ),
    linear-gradient(180deg, rgba(255,255,255,0.14), rgba(255,255,255,0.05));
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.18),
    0 12px 30px rgba(0,0,0,0.44);
  position: relative;
  overflow: hidden;
}

.kx-glyph::after{
  content:"";
  position:absolute;
  inset:-40%;
  background:
    radial-gradient(closest-side, rgba(255,255,255,0.16), rgba(255,255,255,0) 70%);
  transform: translate3d(-20%, -18%, 0) rotate(18deg);
  opacity:.7;
  filter: blur(10px);
  animation: sx-glyph-sheen calc(var(--sx-breath) * 1.2) ease-in-out infinite;
}

@keyframes sx-glyph-sheen{
  0%   { transform: translate3d(-22%, -20%, 0) rotate(16deg); opacity:.55; }
  50%  { transform: translate3d(6%, 2%, 0) rotate(20deg); opacity:.78; }
  100% { transform: translate3d(-22%, -20%, 0) rotate(16deg); opacity:.55; }
}

.kx-title{ display: grid; gap: 6px; min-width: 0; }

.kx-title h1{
  margin: 0;
  font-size: clamp(18px, 3.2vw, 24px);
  letter-spacing: 0.14em;
  word-spacing: 0.1em;
}

.kx-title h1 span{
  color: var(--sx-accent);
  text-shadow: 0 0 1px var(--sx-accent), 0 0 22px rgba(55,255,228,0.25);
  letter-spacing: 0.02em;
}

.kx-tagline{
  color: var(--sx-text-dim);
  font-size: 12px;
  opacity: 0.92;
}

/* Controls */
.kx-controls{
  display: grid;
  gap: 10px;
  grid-template-columns: 1fr;
}

@media (min-width: 680px){
  .kx-controls{
    grid-template-columns: 1fr auto auto;
    align-items: center;
  }
}

/* Add form */
.kx-add-form{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
}

.kx-input{
  width: 100%;
  padding: 11px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.14);
  background:
    radial-gradient(140% 220% at 0% 0%, rgba(55,255,228,0.08), transparent 55%),
    linear-gradient(180deg, rgba(7,12,14,0.74), rgba(7,12,14,0.52));
  color: var(--sx-text);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.06);
  outline: none;
  min-width: 0;
  font-size: 13px;
}

.kx-input::placeholder{
  color: color-mix(in oklab, var(--sx-text-dim) 70%, transparent);
}

.kx-input:focus-visible{
  border-color: rgba(255,255,255,0.22);
  box-shadow: var(--sx-ring);
}

/* Primary button */
.kx-button{
  padding: 11px 16px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.20);
  color: #081917;
  font-weight: 900;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
  background:
    radial-gradient(120% 160% at 0% 0%, rgba(55,255,228,0.28), transparent 42%),
    linear-gradient(180deg, rgba(55,255,228,0.22), rgba(55,255,228,0.10));
  text-shadow: 0 1px 0 rgba(255,255,255,0.30);
  box-shadow:
    0 14px 34px rgba(55,255,228,0.20),
    inset 0 1px 0 rgba(255,255,255,0.26);
  transition: transform .12s ease, box-shadow .18s ease, filter .18s ease;
}

.kx-button:hover{
  transform: translateY(-1px);
  filter: saturate(1.06) brightness(1.03);
  box-shadow:
    0 18px 44px rgba(55,255,228,0.24),
    inset 0 1px 0 rgba(255,255,255,0.32);
}

/* Import / export */
.kx-io{
  display: grid;
  grid-auto-flow: column;
  gap: 8px;
  justify-content: start;
  align-items: center;
}

.kx-import,
.kx-export{
  padding: 10px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.14);
  background:
    radial-gradient(120% 180% at 0% 0%, rgba(183,163,255,0.08), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  color: var(--sx-text);
  cursor: pointer;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.04),
    0 6px 18px rgba(0,0,0,0.35);
  transition: transform .1s ease, box-shadow .2s ease, border-color .2s ease, color .15s ease;
  font-size: 12px;
}

.kx-import:hover,
.kx-export:hover{
  transform: translateY(-1px);
  border-color: rgba(255,255,255,0.24);
  color: var(--sx-accent);
}

.kx-import{
  position: relative;
  display: inline-flex;
  align-items: center;
}

.kx-import input[type="file"]{
  position: absolute;
  inset: 0;
  opacity: 0;
  cursor: pointer;
}

/* Stats */
.kx-stats{
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.kx-pill{
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.14);
  background:
    radial-gradient(140% 240% at 0% 0%, rgba(98,218,255,0.08), transparent 58%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  color: var(--sx-text-dim);
  font-size: 11px;
  white-space: nowrap;
}

.kx-pill.subtle{ opacity: 0.88; }

/* ─────────────────────────────────────────────────────────────
   SCROLL VIEWPORT
   ───────────────────────────────────────────────────────────── */
.explorer-scroll{
  overflow: auto;
  padding: var(--sx-pad);
  display: grid;
  gap: 14px;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain;
  scroll-behavior: smooth;
}

.explorer-inner{
  max-width: var(--sx-maxw);
  margin: 0 auto;
  width: 100%;
  display: grid;
  gap: 14px;
}

/* ─────────────────────────────────────────────────────────────
   EMPTY STATE
   ───────────────────────────────────────────────────────────── */
.kx-empty{
  border: 1px dashed rgba(255,255,255,0.18);
  border-radius: var(--sx-radius);
  background:
    radial-gradient(120% 200% at 0% 0%, rgba(35,255,240,0.10), transparent 58%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  padding: 16px 14px 18px;
  color: var(--sx-text-dim);
  font-size: 13px;
}

.kx-empty p{ margin: 0 0 6px; }
.kx-empty ol{ margin: 6px 0 0; padding-left: 20px; }

/* ─────────────────────────────────────────────────────────────
   FOREST / ORIGINS (chakra-tinted)
   ───────────────────────────────────────────────────────────── */
.forest{ display: grid; gap: 14px; }

.origin{
  --sx-chakra: var(--sx-chakra);
  border: 1px solid rgba(255,255,255,0.16);
  border-radius: var(--sx-radius);
  background:
    radial-gradient(120% 180% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 18%, transparent), transparent 60%),
    radial-gradient(120% 180% at 100% 100%, color-mix(in oklab, var(--sx-chakra) 10%, transparent), transparent 62%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  -webkit-backdrop-filter: blur(18px) saturate(170%);
  backdrop-filter: blur(18px) saturate(170%);
  box-shadow: var(--sx-shadow-card);
  overflow: clip;
  position: relative;
  animation: sx-card-breathe var(--sx-breath) ease-in-out infinite;
}

.origin::before{
  content:"";
  position:absolute;
  inset: 0;
  pointer-events:none;
  background:
    radial-gradient(900px 420px at 20% 10%, rgba(255,255,255,0.10), transparent 60%),
    repeating-linear-gradient(
      135deg,
      rgba(255,255,255,0.05) 0px,
      rgba(255,255,255,0.05) 1px,
      rgba(0,0,0,0.0) 10px,
      rgba(0,0,0,0.0) 16px
    );
  mix-blend-mode: overlay;
  opacity: .35;
}

@keyframes sx-card-breathe{
  0%   { filter: brightness(1) saturate(1); }
  50%  { filter: brightness(1.04) saturate(1.06); }
  100% { filter: brightness(1) saturate(1); }
}

/* Origin header */
.origin-head{
  display: grid;
  gap: 8px;
  padding: 11px 14px;
  border-bottom: 1px dashed rgba(255,255,255,0.10);
  background:
    radial-gradient(140% 240% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 16%, transparent), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
  grid-template-columns: 1fr;
}

@media (min-width: 720px){
  .origin-head{ grid-template-columns: 1fr auto; align-items: center; }
}

.o-meta{
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
  min-width: 0;
}

.o-title{
  font-weight: 900;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: color-mix(in oklab, var(--sx-chakra) 78%, var(--sx-text));
  font-size: 11px;
}

.o-link{
  color: var(--sx-text);
  text-decoration: none;
  border-bottom: 1px dashed rgba(255,255,255,0.18);
  max-width: 60ch;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-weight: 700;
}

.o-link:hover{
  color: var(--sx-accent-3);
  text-shadow: 0 0 14px rgba(92,225,255,0.30);
}

.o-chakra{
  padding: 5px 9px;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--sx-chakra) 55%, rgba(255,255,255,0.12));
  background:
    radial-gradient(120% 200% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 22%, transparent), transparent 60%),
    linear-gradient(180deg, color-mix(in oklab, var(--sx-chakra) 26%, transparent), rgba(255,255,255,0.02));
  color: #f8fbff;
  font-size: 11px;
  white-space: nowrap;
  text-shadow: 0 1px 0 rgba(0,0,0,0.25);
}

.o-right{
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.o-count{ color: var(--sx-text-dim); font-size: 11px; }

.o-copy{
  padding: 7px 11px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.14);
  background:
    radial-gradient(140% 220% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 12%, transparent), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  color: var(--sx-text);
  cursor: pointer;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.04),
    0 6px 18px rgba(0,0,0,0.35);
  font-size: 11px;
  transition: transform .12s ease, filter .18s ease, border-color .18s ease;
}

.o-copy:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--sx-chakra) 60%, rgba(255,255,255,0.16));
  filter: saturate(1.06) brightness(1.03);
}

/* Origin body */
.origin-body{
  padding: 8px 9px 10px;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* ─────────────────────────────────────────────────────────────
   TREE / NODES (chakra-tinted, etched, breathing)
   ───────────────────────────────────────────────────────────── */
.tree{
  display: flex;
  flex-direction: column;
  gap: 7px;
  min-width: min-content;
}

.node{
  /* per-node chakra tint injected by TS via style: --sx-chakra */
  border-radius: var(--sx-radius-sm);
  border: 1px solid rgba(255,255,255,0.16);
  background:
    radial-gradient(140% 260% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 22%, transparent), transparent 58%),
    radial-gradient(160% 240% at 110% 100%, color-mix(in oklab, var(--sx-chakra) 12%, transparent), transparent 62%),
    linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
  box-shadow:
    0 14px 34px rgba(0,0,0,0.58),
    inset 0 1px 0 rgba(255,255,255,0.06);
  position: relative;
  overflow: hidden;
  animation: sx-node-breathe var(--sx-breath) ease-in-out infinite;
}

.node::before{
  content:"";
  position:absolute;
  inset: 0;
  pointer-events:none;
  background:
    radial-gradient(900px 420px at 20% 10%, rgba(255,255,255,0.10), transparent 62%),
    radial-gradient(620px 320px at 90% 80%, color-mix(in oklab, var(--sx-chakra) 14%, transparent), transparent 65%),
    repeating-linear-gradient(
      135deg,
      rgba(255,255,255,0.05) 0px,
      rgba(255,255,255,0.05) 1px,
      rgba(0,0,0,0.0) 11px,
      rgba(0,0,0,0.0) 18px
    );
  mix-blend-mode: overlay;
  opacity: .34;
}

.node::after{
  content:"";
  position:absolute;
  inset:-40%;
  pointer-events:none;
  background:
    conic-gradient(
      from 180deg,
      rgba(255,255,255,0.00),
      color-mix(in oklab, var(--sx-chakra) 14%, transparent),
      rgba(255,255,255,0.00),
      color-mix(in oklab, var(--sx-chakra) 10%, transparent),
      rgba(255,255,255,0.00)
    );
  filter: blur(18px);
  opacity: .26;
  transform: translate3d(-8%, -10%, 0);
  animation: sx-node-caustic calc(var(--sx-breath) * 1.4) ease-in-out infinite;
}

@keyframes sx-node-breathe{
  0%   { filter: brightness(1) saturate(1); }
  50%  { filter: brightness(1.05) saturate(1.08); }
  100% { filter: brightness(1) saturate(1); }
}

@keyframes sx-node-caustic{
  0%   { transform: translate3d(-10%, -12%, 0) rotate(0deg); opacity:.20; }
  50%  { transform: translate3d(6%, 4%, 0) rotate(6deg); opacity:.34; }
  100% { transform: translate3d(-10%, -12%, 0) rotate(0deg); opacity:.20; }
}

/* Node row layout (desktop = 2 columns, mobile = stacked two-row) */
.node-row{
  display: grid;
  grid-template-columns: minmax(0, 2.2fr) minmax(0, 2fr);
  gap: 8px 10px;
  align-items: center;
  padding: 8px 10px;
}

@media (max-width: 760px){
  .node-row{ grid-template-columns: minmax(0, 1fr); }
  .node-meta{ justify-content: flex-start; }
}

/* Left */
.node-main{
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

/* Right */
.node-meta{
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  justify-content: flex-end;
  gap: 6px;
}

/* Twirl */
.twirl{
  width: 30px;
  height: 30px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.18);
  background:
    radial-gradient(140% 240% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 14%, transparent), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
  color: var(--sx-text);
  display: inline-grid;
  place-items: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: transform .12s ease, filter .16s ease, border-color .16s ease;
}

.twirl:hover{
  transform: translateY(-1px);
  filter: brightness(1.05) saturate(1.06);
  border-color: color-mix(in oklab, var(--sx-chakra) 55%, rgba(255,255,255,0.14));
}

.tw{
  width: 10px;
  height: 10px;
  border-right: 2px solid currentColor;
  border-bottom: 2px solid currentColor;
  transform: rotate(-45deg);
  transition: transform .18s ease, color .18s ease;
  opacity: .92;
}

.tw.open{
  transform: rotate(45deg);
  color: color-mix(in oklab, var(--sx-chakra) 80%, white);
}

/* Node link */
.node-link{
  min-width: 0;
  color: var(--sx-text);
  text-decoration: none;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-weight: 700;
}

.node-link span{
  padding: 6px 9px;
  border-radius: 10px;
  background:
    radial-gradient(140% 220% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 32%, transparent), transparent 60%),
    linear-gradient(180deg, color-mix(in oklab, var(--sx-chakra) 16%, transparent), rgba(255,255,255,0.02));
  border: 1px solid color-mix(in oklab, var(--sx-chakra) 70%, rgba(255,255,255,0.14));
  text-shadow:
    0 0 18px color-mix(in oklab, var(--sx-chakra) 35%, transparent),
    0 1px 0 rgba(0,0,0,0.25);
}

.node-link:hover{
  color: var(--sx-accent-3);
}

/* Kai time pills */
.k-stamp{
  display: inline-flex;
  gap: 6px;
  align-items: center;
  flex-wrap: wrap;
  font-size: 11px;
  color: var(--sx-text-dim);
}

.k-pill{
  padding: 5px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.15);
  background:
    radial-gradient(140% 220% at 0% 0%, rgba(255,255,255,0.05), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  white-space: nowrap;
}

.k-dot{ opacity: 0.6; }

/* Chakra badge (NOW chakra-colored, not purple) */
.chakra{
  padding: 5px 9px;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--sx-chakra) 55%, rgba(255,255,255,0.12));
  background:
    radial-gradient(140% 220% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 22%, transparent), transparent 60%),
    linear-gradient(180deg, color-mix(in oklab, var(--sx-chakra) 18%, transparent), rgba(255,255,255,0.02));
  color: #f8fbff;
  font-size: 11px;
  white-space: nowrap;
  text-shadow: 0 1px 0 rgba(0,0,0,0.25);
}

/* Φ pill */
.phi-pill{
  padding: 5px 9px;
  border-radius: 999px;
  border: 1px solid rgba(255, 215, 128, 0.62);
  background:
    radial-gradient(140% 220% at 0% 0%, rgba(255,215,128,0.22), transparent 62%),
    linear-gradient(180deg, rgba(255,215,128,0.22), rgba(255,215,128,0.06));
  color: #fff8e0;
  font-size: 11px;
  white-space: nowrap;
  text-shadow: 0 1px 0 rgba(0,0,0,0.25);
}

/* Copy button */
.node-copy{
  width: 30px;
  height: 30px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.16);
  background:
    radial-gradient(140% 220% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 14%, transparent), transparent 62%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  color: var(--sx-text);
  cursor: pointer;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.04),
    0 6px 18px rgba(0,0,0,0.35);
  flex-shrink: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  transition: transform .12s ease, filter .16s ease, border-color .16s ease;
}

.node-copy:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--sx-chakra) 60%, rgba(255,255,255,0.14));
  filter: brightness(1.05) saturate(1.06);
}

/* Open area */
.node-open{
  border-top: 1px dashed rgba(255,255,255,0.14);
}

/* Detail panel */
.node-detail,
.node-details{
  padding: 8px 10px 10px;
  font-size: 11px;
  color: var(--sx-text-dim);
  background:
    radial-gradient(140% 220% at 0% 0%, color-mix(in oklab, var(--sx-chakra) 12%, transparent), transparent 62%),
    linear-gradient(180deg, rgba(5,10,11,0.92), rgba(5,10,11,0.82));
}

.node-detail-grid,
.node-details-grid{
  display: grid;
  grid-template-columns: auto minmax(0, 1fr);
  column-gap: 10px;
  row-gap: 4px;
  align-items: baseline;
}

@media (max-width: 640px){
  .node-detail-grid,
  .node-details-grid{ grid-template-columns: minmax(0, 1fr); }
}

.detail-label{
  opacity: 0.82;
  text-transform: uppercase;
  letter-spacing: 0.14em;
  font-weight: 700;
  font-size: 10px;
}

.detail-value{
  font-family: var(--sx-mono);
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.detail-value strong{ font-weight: 700; color: var(--sx-text); }

.node-detail-empty{
  opacity: 0.88;
  padding: 4px 0 2px;
}

/* Children rail (NOW chakra-tinted per parent node) */
.node-children{
  margin: 6px 0 8px 20px;
  padding: 8px 0 4px 12px;
  display: flex;
  flex-direction: column;
  gap: 7px;
  position: relative;
}

.node-children::before{
  content: "";
  position: absolute;
  left: 0;
  top: 6px;
  bottom: 10px;
  width: 2px;
  background: linear-gradient(
    180deg,
    color-mix(in oklab, var(--sx-chakra) 70%, transparent),
    rgba(0,0,0,0)
  );
  border-radius: 1px;
  box-shadow:
    0 0 18px color-mix(in oklab, var(--sx-chakra) 26%, transparent);
}

/* Empty branch inside origin */
.origin-body .kx-empty{ margin: 4px 2px 6px; }

/* ─────────────────────────────────────────────────────────────
   FOOTER — ULTRA SLIM
   ───────────────────────────────────────────────────────────── */
.kx-footer{
  color: var(--sx-text-dim);
  text-align: center;
  font-size: 11px;
  padding: 6px 4px 4px;
  opacity: 0.9;
}

.kx-footer .row{
  display: inline-flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.kx-footer .dot{ opacity: 0.6; }

/* ─────────────────────────────────────────────────────────────
   SCROLLBAR POLISH (scoped)
   ───────────────────────────────────────────────────────────── */
.explorer-scroll,
.origin-body{
  scrollbar-width: thin;
  scrollbar-color: rgba(55, 255, 228, 0.5) transparent;
}

.explorer-scroll::-webkit-scrollbar,
.origin-body::-webkit-scrollbar{
  height: 8px;
  width: 8px;
}

.explorer-scroll::-webkit-scrollbar-thumb,
.origin-body::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, rgba(55,255,228,0.35), rgba(55,255,228,0.15));
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

.explorer-scroll::-webkit-scrollbar-track,
.origin-body::-webkit-scrollbar-track{
  background: transparent;
}

/* ─────────────────────────────────────────────────────────────
   A11Y / MOTION
   ───────────────────────────────────────────────────────────── */
.sigil-explorer :is(button, a, input){
  outline: none;
}

.sigil-explorer :is(button, a, input):focus-visible{
  box-shadow: var(--sx-ring);
  border-color: rgba(255,255,255,0.24);
}

@media (prefers-reduced-motion: reduce){
  .sigil-explorer::after,
  .origin,
  .node,
  .kx-button,
  .tw,
  .kx-glyph::after{
    transition: none !important;
    animation: none !important;
  }
}
