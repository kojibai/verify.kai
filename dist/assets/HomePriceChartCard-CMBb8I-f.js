import{Tn as e,an as t,bt as n,jn as r,ln as i,tn as a,yt as o}from"./index-BGzUQCv_.js";import{t as s}from"./prop-types-CQvzhoSE.js";var c=r(e(),1),l=`clover`,u=function(e){return e===3?`v3`:e},d=`https://js.stripe.com`,f=`${d}/${l}/stripe.js`,p=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ee=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,m=`loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used`,h=function(e){return p.test(e)||ee.test(e)},g=function(){for(var e=document.querySelectorAll(`script[src^="${d}"]`),t=0;t<e.length;t++){var n=e[t];if(h(n.src))return n}return null},_=function(e){var t=e&&!e.advancedFraudSignals?`?advancedFraudSignals=false`:``,n=document.createElement(`script`);n.src=`${f}${t}`;var r=document.head||document.body;if(!r)throw Error(`Expected document.body not to be null. Stripe.js requires a <body> element.`);return r.appendChild(n),n},te=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:`stripe-js`,version:`8.6.0`,startTime:t})},v=null,y=null,b=null,x=function(e){return function(t){e(Error(`Failed to load Stripe.js`,{cause:t}))}},S=function(e,t){return function(){window.Stripe?e(window.Stripe):t(Error(`Stripe.js not available`))}},C=function(e){return v===null?(v=new Promise(function(t,n){if(typeof window>`u`||typeof document>`u`){t(null);return}if(window.Stripe&&e&&console.warn(m),window.Stripe){t(window.Stripe);return}try{var r=g();if(r&&e)console.warn(m);else if(!r)r=_(e);else if(r&&b!==null&&y!==null){var i;r.removeEventListener(`load`,b),r.removeEventListener(`error`,y),(i=r.parentNode)==null||i.removeChild(r),r=_(e)}b=S(t,n),y=x(n),r.addEventListener(`load`,b),r.addEventListener(`error`,y)}catch(e){n(e);return}}),v.catch(function(e){return v=null,Promise.reject(e)})):v},w=function(e,t,n){if(e===null)return null;var r=t[0].match(/^pk_test/),i=u(e.version),a=l;r&&i!==a&&console.warn(`Stripe.js@${i} was loaded on the page, but @stripe/stripe-js@8.6.0 expected Stripe.js@${a}. This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning`);var o=e.apply(void 0,t);return te(o,n),o},T,E=!1,D=function(){return T||(T=C(null).catch(function(e){return T=null,Promise.reject(e)}),T)};Promise.resolve().then(function(){return D()}).catch(function(e){E||console.warn(e)});var O=function(){var e=[...arguments];E=!0;var t=Date.now();return D().then(function(n){return w(n,e,t)})},k=r(s(),1);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?A(Object(n),!0).forEach(function(t){N(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e){"@babel/helpers - typeof";return M=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},M(e)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function re(e,t){if(e==null)return{};var n=ne(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ie(e,t){return P(e)||ae(e,t)||F(e,t)||oe()}function P(e){if(Array.isArray(e))return e}function ae(e,t){var n=e&&(typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`]);if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(e){a=!0,s=e}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function F(e,t){if(e){if(typeof e==`string`)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}function I(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function oe(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=function(e,t,n){var r=!!n,i=c.useRef(n);c.useEffect(function(){i.current=n},[n]),c.useEffect(function(){if(!r||!e)return function(){};var n=function(){i.current&&i.current.apply(i,arguments)};return e.on(t,n),function(){e.off(t,n)}},[r,t,e,i])},R=function(e){var t=c.useRef(e);return c.useEffect(function(){t.current=e},[e]),t.current},z=function(e){return e!==null&&M(e)===`object`},B=function(e){return z(e)&&typeof e.then==`function`},V=function(e){return z(e)&&typeof e.elements==`function`&&typeof e.createToken==`function`&&typeof e.createPaymentMethod==`function`&&typeof e.confirmCardPayment==`function`},se=`[object Object]`,ce=function e(t,n){if(!z(t)||!z(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var i=Object.prototype.toString.call(t)===se;if(i!==(Object.prototype.toString.call(n)===se))return!1;if(!i&&!r)return t===n;var a=Object.keys(t),o=Object.keys(n);if(a.length!==o.length)return!1;for(var s={},c=0;c<a.length;c+=1)s[a[c]]=!0;for(var l=0;l<o.length;l+=1)s[o[l]]=!0;var u=Object.keys(s);if(u.length!==a.length)return!1;var d=t,f=n;return u.every(function(t){return e(d[t],f[t])})},le=function(e,t,n){return z(e)?Object.keys(e).reduce(function(r,i){var a=!z(t)||!ce(e[i],t[i]);return n.includes(i)?(a&&console.warn(`Unsupported prop change: options.${i} is not a mutable property.`),r):a?j(j({},r||{}),{},N({},i,e[i])):r},null):null},ue="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",H=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ue;if(e===null||V(e))return e;throw Error(t)},U=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ue;if(B(e))return{tag:`async`,stripePromise:Promise.resolve(e).then(function(e){return H(e,t)})};var n=H(e,t);return n===null?{tag:`empty`}:{tag:`sync`,stripe:n}},W=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:`react-stripe-js`,version:`5.4.1`}),e.registerAppInfo({name:`react-stripe-js`,version:`5.4.1`,url:`https://stripe.com/docs/stripe-js/react`}))},G=c.createContext(null);G.displayName=`ElementsContext`;var de=function(e,t){if(!e)throw Error(`Could not find Elements context; You need to wrap the part of your app that ${t} in an <Elements> provider.`);return e},K=function(e){var t=e.stripe,n=e.options,r=e.children,i=c.useMemo(function(){return U(t)},[t]),a=ie(c.useState(function(){return{stripe:i.tag===`sync`?i.stripe:null,elements:i.tag===`sync`?i.stripe.elements(n):null}}),2),o=a[0],s=a[1];c.useEffect(function(){var e=!0,t=function(e){s(function(t){return t.stripe?t:{stripe:e,elements:e.elements(n)}})};return i.tag===`async`&&!o.stripe?i.stripePromise.then(function(n){n&&e&&t(n)}):i.tag===`sync`&&!o.stripe&&t(i.stripe),function(){e=!1}},[i,o,n]);var l=R(t);c.useEffect(function(){l!==null&&l!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[l,t]);var u=R(n);return c.useEffect(function(){if(o.elements){var e=le(n,u,[`clientSecret`,`fonts`]);e&&o.elements.update(e)}},[n,u,o.elements]),c.useEffect(function(){W(o.stripe)},[o.stripe]),c.createElement(G.Provider,{value:o},r)};K.propTypes={stripe:k.default.any,options:k.default.object};var fe=function(e){return de(c.useContext(G),e)},pe=function(){return fe(`calls useElements()`).elements},me=function(e){var t=e.children;return t(fe(`mounts <ElementsConsumer>`))};me.propTypes={children:k.default.func.isRequired};var q=c.createContext(null);q.displayName=`CheckoutContext`,k.default.any,k.default.shape({clientSecret:k.default.oneOfType([k.default.string,k.default.instanceOf(Promise)]).isRequired,elementsOptions:k.default.object}).isRequired;var J=function(e){var t=c.useContext(q),n=c.useContext(G);if(t){if(n)throw Error(`You cannot wrap the part of your app that ${e} in both <CheckoutProvider> and <Elements> providers.`);return t}else return de(n,e)},Y=[`mode`],he=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},X=function(e,t){var n=`${he(e)}Element`,r=t?function(e){J(`mounts <${n}>`);var t=e.id,r=e.className;return c.createElement(`div`,{id:t,className:r})}:function(t){var r=t.id,i=t.className,a=t.options,o=a===void 0?{}:a,s=t.onBlur,l=t.onFocus,u=t.onReady,d=t.onChange,f=t.onEscape,p=t.onClick,ee=t.onLoadError,m=t.onLoaderStart,h=t.onNetworksChange,g=t.onConfirm,_=t.onCancel,te=t.onShippingAddressChange,v=t.onShippingRateChange,y=t.onSavedPaymentMethodRemove,b=t.onSavedPaymentMethodUpdate,x=J(`mounts <${n}>`),S=`elements`in x?x.elements:null,C=`checkoutState`in x?x.checkoutState:null,w=C?.type===`success`||C?.type===`loading`?C.sdk:null,T=ie(c.useState(null),2),E=T[0],D=T[1],O=c.useRef(null),k=c.useRef(null);L(E,`blur`,s),L(E,`focus`,l),L(E,`escape`,f),L(E,`click`,p),L(E,`loaderror`,ee),L(E,`loaderstart`,m),L(E,`networkschange`,h),L(E,`confirm`,g),L(E,`cancel`,_),L(E,`shippingaddresschange`,te),L(E,`shippingratechange`,v),L(E,`savedpaymentmethodremove`,y),L(E,`savedpaymentmethodupdate`,b),L(E,`change`,d);var A;u&&(A=e===`expressCheckout`?u:function(){u(E)}),L(E,`ready`,A),c.useLayoutEffect(function(){if(O.current===null&&k.current!==null&&(S||w)){var t=null;if(w)switch(e){case`paymentForm`:t=w.createPaymentFormElement();break;case`payment`:t=w.createPaymentElement(o);break;case`address`:if(`mode`in o){var r=o.mode,i=re(o,Y);if(r===`shipping`)t=w.createShippingAddressElement(i);else if(r===`billing`)t=w.createBillingAddressElement(i);else throw Error(`Invalid options.mode. mode must be 'billing' or 'shipping'.`)}else throw Error(`You must supply options.mode. mode must be 'billing' or 'shipping'.`);break;case`expressCheckout`:t=w.createExpressCheckoutElement(o);break;case`currencySelector`:t=w.createCurrencySelectorElement();break;case`taxId`:t=w.createTaxIdElement(o);break;default:throw Error(`Invalid Element type ${n}. You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />.`)}else S&&(t=S.create(e,o));O.current=t,D(t),t&&t.mount(k.current)}},[S,w,o]);var j=R(o);return c.useEffect(function(){if(O.current){var e=le(o,j,[`paymentRequest`]);e&&`update`in O.current&&O.current.update(e)}},[o,j]),c.useLayoutEffect(function(){return function(){if(O.current&&typeof O.current.destroy==`function`)try{O.current.destroy(),O.current=null}catch{}}},[]),c.createElement(`div`,{id:r,className:i,ref:k})};return r.propTypes={id:k.default.string,className:k.default.string,onChange:k.default.func,onBlur:k.default.func,onFocus:k.default.func,onReady:k.default.func,onEscape:k.default.func,onClick:k.default.func,onLoadError:k.default.func,onLoaderStart:k.default.func,onNetworksChange:k.default.func,onConfirm:k.default.func,onCancel:k.default.func,onShippingAddressChange:k.default.func,onShippingRateChange:k.default.func,onSavedPaymentMethodRemove:k.default.func,onSavedPaymentMethodUpdate:k.default.func,options:k.default.object},r.displayName=n,r.__elementType=e,r},Z=typeof window>`u`,ge=c.createContext(null);ge.displayName=`EmbeddedCheckoutProviderContext`;var _e=function(){return J(`calls useStripe()`).stripe};X(`auBankAccount`,Z),X(`card`,Z),X(`cardNumber`,Z),X(`cardExpiry`,Z),X(`cardCvc`,Z),X(`iban`,Z);var ve=X(`payment`,Z);X(`expressCheckout`,Z),X(`paymentRequestButton`,Z),X(`linkAuthentication`,Z),X(`address`,Z),X(`shippingAddress`,Z),X(`paymentMethodMessaging`,Z),X(`taxId`,Z);var Q=r(a(),1),ye=i,$=e=>globalThis[e],be=()=>{let e=$(`kaiPulseNowBridge`)??$(`kaiPulseNow`);return typeof e==`function`?e():(performance.timeOrigin+performance.now()-t)/i},xe=(e,t,n)=>Math.max(t,Math.min(n,e)),Se=e=>Math.round(e*100)/100,Ce=e=>e.toLocaleString(`en-US`,{style:`currency`,currency:`USD`,minimumFractionDigits:2,maximumFractionDigits:2}),we=(e,t)=>{let n=(1+Math.sqrt(5))/2,r=Math.sin(2*Math.PI*e/44)*.85,i=Math.sin(2*Math.PI*n*e)*.42,a=Math.sin(2*Math.PI*(n-1)*e)*.28,o=Math.sin(e*.1618)*.35;return Se(t+r+i+a+o)},Te=e=>xe(.35+.65*Math.abs(Math.sin(2*Math.PI*e/11)),0,1),Ee=Object.freeze([]),De=Object.freeze([]),Oe=`
.kai-price-wrap { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji"; color: #e7fbf7; }
.kai-price-chart { display:block; width:100%; height:auto; }
.kpc-title { fill:#a2bbb6; font-size:12px; font-weight:600; letter-spacing:0.4px; }
.kpc-gridline { stroke:#ffffff22; stroke-width:1; shape-rendering:crispEdges; }
.kpc-band { stroke:#81fff133; stroke-width:1; stroke-dasharray:4 4; }
.kpc-line { fill:none; stroke:#37e6d4; stroke-width:2.25; }
.kpc-area { opacity:1; }
.kpc-axes .kpc-axis-text { fill:#a2bbb6; font-size:11px; dominant-baseline:middle; }
.kpc-dot { fill:#37e6d4; stroke:#0a0f12; stroke-width:2; }
.kpc-badge { fill:#0a0f12cc; stroke:#ffffff22; stroke-width:1; }
.kpc-badge-text { fill:#e7fbf7; font-size:11px; font-weight:600; }
.kpc-xhair-line { stroke:#ffffff33; stroke-width:1; shape-rendering:crispEdges; }
.kpc-tip { fill:#0a0f12f2; stroke:#ffffff22; }
.kpc-tip-text { fill:#e7fbf7; font-size:11px; font-weight:600; }
.kpc-header text { user-select:none; }
.kpc-ticker { display:flex; align-items:center; gap:10px; margin-bottom:6px; font-size:12px; color:#a2bbb6; }
.kpc-live-dot { width:8px; height:8px; border-radius:9999px; background:#28c76f; box-shadow:0 0 0 6px #28c76f22; }
.kpc-live { font-weight:700; letter-spacing:0.08em; color:#a2bbb6; }
.kpc-last { font-weight:700; color:#e7fbf7; }
.kpc-last.up { color:#c1ffe9; }
.kpc-last.down { color:#ffd1d1; }
.kpc-delta.up { color:#28c76f; }
.kpc-delta.down { color:#ff4d4f; }
.kpc-pulse { color:#a2bbb6; }
.kpc-empty { display:flex; align-items:center; justify-content:center; color:#a2bbb6; height:100%; font-size:12px; }
`,ke={l:64,r:20,t:28,b:36},Ae=(e,t,n,r)=>{let i=Math.floor(t),a=Math.floor(n),o=Math.max(String(i).length,String(a).length,1)*7+18,s=xe(Math.ceil(o+14),56,140),c=Math.max(1,Math.floor(e/s));return xe(Math.min(r,c),1,Math.max(1,r))},je=({points:e,width:t=720,height:n=280,title:r=`Φ Value — Live (☤Kai)`,className:i,style:a,formatter:o=Ce,gridXTicks:s=6,gridYTicks:l=4,bandLevels:u=[.236,.382,.5,.618],showVWAP:d=!0,autoWidth:f=!1,includeStyles:p=!0,onHoverPoint:ee,live:m=!0,windowPoints:h=240,priceFn:g,volFn:_,tickAlignToPulse:te=!0,tickMs:v=ye,fetchSigilMeta:y,buildExchangeSeries:b,issuancePolicy:x,onTick:S})=>{let C=ke,w=c.useRef(null),[T,E]=c.useState(t),D=c.useRef(y??$(`fetchSigilMeta`)),O=c.useRef(b??$(`buildExchangeSeries`)),k=c.useRef(x??$(`DEFAULT_ISSUANCE_POLICY`));c.useEffect(()=>{D.current=y??$(`fetchSigilMeta`)},[y]),c.useEffect(()=>{O.current=b??$(`buildExchangeSeries`)},[b]),c.useEffect(()=>{k.current=x??$(`DEFAULT_ISSUANCE_POLICY`)},[x]);let[A,j]=c.useState([]),M=c.useRef(null),N=c.useRef(null),[ne,re]=c.useState(null);c.useLayoutEffect(()=>{if(!w.current)return;let e=w.current,n=()=>{let n=Math.floor(e.getBoundingClientRect().width||t);n>0&&E(n)};if(n(),typeof ResizeObserver>`u`)return;let r=new ResizeObserver(()=>n());return r.observe(e),()=>r.disconnect()},[t]),c.useEffect(()=>{let e=!0,t=D.current;return t&&t().then(t=>{e&&re(t)}).catch(()=>{}),()=>{e=!1}},[]);let ie=c.useCallback((e,t)=>{if(g)return{price:Se(Math.max(1e-4,g(e))),vol:_?xe(_(e),0,1):Te(e)};let n=O.current,r=k.current;if(ne&&typeof n==`function`&&r)try{let t=Math.max(0,e-11),i=n({meta:ne,usdSample:100},r,t,e,11),a=i?.[i.length-1];if(a&&typeof a.usdPerPhi==`number`){let e=a.choirActive||a.festivalActive?.5:.25;return{price:Se(Math.max(1e-4,a.usdPerPhi)),vol:e}}}catch{}let i=t??1.618,a=Math.max(1e-4,we(e,i)),o=Te(e);return{price:Se(a),vol:o}},[ne,g,_]);c.useEffect(()=>{if(!m)return;let t=be(),n=Math.floor(t),r=n-(Math.max(2,h)-1),i=e??Ee,a=[],o=i.length>0?i[i.length-1].price:null;for(let e=r;e<=n;e++){let{price:t,vol:n}=ie(e,o);a.push({p:e,price:t,vol:n}),o=t}if(j(a),M.current=n,N.current=a.length>0?a[a.length-1].price:null,S&&a.length>0){let e=a[a.length-1];S({p:e.p,price:e.price})}},[m,h,ie,ne,S,e]),c.useEffect(()=>{if(!m)return;let e,t=()=>{let e=be(),t=Math.floor(e);if(M.current==null||t>M.current){let e=N.current,n=ie(t,e);j(e=>{let r=[...e,{p:t,price:n.price,vol:n.vol}];return r.length>h?r.slice(r.length-h):r}),M.current=t,N.current=n.price,S&&S({p:t,price:n.price})}n()},n=()=>{if(te){let n=be(),r=n-Math.floor(n),i=Math.max(1,(1-r)*ye);e=window.setTimeout(t,i+2)}else e=window.setTimeout(t,v)};return n(),()=>{e&&window.clearTimeout(e)}},[m,h,ie,te,v,S]);let P=c.useMemo(()=>m?A:e??Ee,[m,A,e]),ae=f?T:t,F=Math.max(10,ae-C.l-C.r),I=Math.max(10,n-C.t-C.b),oe=Math.max(10,T||t),L=Math.max(10,oe-C.l-C.r),{minX:R,maxX:z,minY:B,maxY:V,vwap:se}=c.useMemo(()=>{if(P.length===0)return{minX:0,maxX:1,minY:1,maxY:2,vwap:0};let e=P.map(e=>e.p),t=P.map(e=>e.price),n=P.map(e=>e.vol??0),r=Math.min(...e),i=Math.max(...e),a=Math.min(...t),o=Math.max(...t),s=n.reduce((e,t)=>e+t,0)||1,c=P.reduce((e,t)=>e+t.price*(t.vol??0),0)/s,l=(o-a)*.12||.5;return{minX:r,maxX:i,minY:Math.max(0,a-l),maxY:o+l,vwap:c}},[P]),ce=c.useMemo(()=>Ae(L,R,z,Math.max(1,s)),[L,R,z,s]),le=c.useCallback(e=>z===R?0:(e-R)/(z-R),[R,z]),ue=c.useCallback(e=>V===B?1:1-(e-B)/(V-B),[B,V]),H=c.useCallback(e=>le(e)*F+C.l,[le,F,C.l]),U=c.useCallback(e=>ue(e)*I+C.t,[ue,I,C.t]),W=c.useMemo(()=>P.map(e=>({x:H(e.p),y:U(e.price)})),[P,H,U]),G=c.useMemo(()=>{if(W.length<2)return``;let e=(e,t,n,r)=>{let i=.5;return{c1x:t.x+(n.x-e.x)*i/6,c1y:t.y+(n.y-e.y)*i/6,c2x:n.x-(r.x-t.x)*i/6,c2y:n.y-(r.y-t.y)*i/6}},t=`M${W[0].x.toFixed(2)} ${W[0].y.toFixed(2)}`;for(let n=0;n<W.length-1;n++){let r=W[n-1]||W[n],i=W[n],a=W[n+1],{c1x:o,c1y:s,c2x:c,c2y:l}=e(r,i,a,W[n+2]||a);t+=` C${o.toFixed(2)} ${s.toFixed(2)}, ${c.toFixed(2)} ${l.toFixed(2)}, ${a.x.toFixed(2)} ${a.y.toFixed(2)}`}return t},[W]),de=c.useMemo(()=>{if(!G||W.length===0)return``;let e=C.t+I,t=W[W.length-1],n=W[0];return`${G} L${t.x.toFixed(2)} ${e.toFixed(2)} L${n.x.toFixed(2)} ${e.toFixed(2)} Z`},[G,W,I,C.t]),[K,fe]=c.useState(null),pe=e=>{let t=e.currentTarget.getBoundingClientRect(),n=R+(xe(e.clientX-t.left,C.l,C.l+F)-C.l)/F*(z-R);if(P.length===0){fe(null),ee?.(null);return}let r=P[0],i=Math.abs(r.p-n);for(let e of P){let t=Math.abs(e.p-n);t<i&&(i=t,r=e)}fe({x:H(r.p),y:U(r.price),p:r.p,price:r.price}),ee?.({p:r.p,price:r.price})},me=()=>{fe(null),ee?.(null)},q=P.length>0?P[P.length-1]:void 0,J=P.length>1?P[P.length-2]:void 0,Y=q&&J?Se(q.price-J.price):0,he=q&&J&&J.price!==0?Y/J.price*100:0,X=c.useMemo(()=>{if(!K)return null;let e=C.l,t=C.l+F,n=C.t,r=C.t+I,i=K.x+10;i+184>t&&(i=K.x-10-184);let a=e+6,o=Math.max(a,t-184-6);i=xe(i,a,o);let s=K.y-22;s<n+6&&(s=K.y+10);let c=n+6,l=Math.max(c,r-36-6);return s=xe(s,c,l),{x:i,y:s,w:184,h:36,textX:i+8,textY:s+20}},[K,F,I,C.l,C.t]);return(0,Q.jsxs)(`div`,{ref:w,className:`kai-price-wrap ${i??``}`,style:a,children:[p&&(0,Q.jsx)(`style`,{dangerouslySetInnerHTML:{__html:Oe}}),(0,Q.jsxs)(`div`,{className:`kpc-ticker`,"aria-live":`polite`,children:[(0,Q.jsx)(`div`,{className:`kpc-live-dot`,"aria-hidden":!0}),(0,Q.jsx)(`div`,{className:`kpc-live`,children:`LIVE`}),(0,Q.jsx)(`div`,{className:`kpc-last ${Y>=0?`up`:`down`}`,children:q?o(q.price):`—`}),(0,Q.jsxs)(`div`,{className:`kpc-delta ${Y>=0?`up`:`down`}`,children:[Y>=0?`▲`:`▼`,` `,o(Math.abs(Y)),` (`,he>=0?`+`:``,he.toFixed(2),`%)`]}),q&&(0,Q.jsxs)(`div`,{className:`kpc-pulse`,children:[`☤KAI `,Math.floor(q.p)]})]}),(0,Q.jsxs)(`svg`,{width:f?T:t,height:n,className:`kai-price-chart`,onMouseMove:pe,onMouseLeave:me,role:`img`,"aria-label":`Live Φ value in fiat over ☤KAI Pulses`,children:[(0,Q.jsxs)(`defs`,{children:[(0,Q.jsxs)(`filter`,{id:`kpc-glow`,x:`-50%`,y:`-50%`,width:`200%`,height:`200%`,children:[(0,Q.jsx)(`feGaussianBlur`,{stdDeviation:`4`,result:`coloredBlur`}),(0,Q.jsxs)(`feMerge`,{children:[(0,Q.jsx)(`feMergeNode`,{in:`coloredBlur`}),(0,Q.jsx)(`feMergeNode`,{in:`SourceGraphic`})]})]}),(0,Q.jsxs)(`linearGradient`,{id:`kpc-fill`,x1:`0`,y1:`0`,x2:`0`,y2:`1`,children:[(0,Q.jsx)(`stop`,{offset:`0%`,stopColor:`rgba(55,255,228,0.28)`}),(0,Q.jsx)(`stop`,{offset:`100%`,stopColor:`rgba(55,255,228,0.00)`})]}),(0,Q.jsxs)(`linearGradient`,{id:`kpc-band`,x1:`0`,y1:`0`,x2:`0`,y2:`1`,children:[(0,Q.jsx)(`stop`,{offset:`0%`,stopColor:`rgba(167,139,250,0.12)`}),(0,Q.jsx)(`stop`,{offset:`100%`,stopColor:`rgba(55,255,228,0.12)`})]})]}),(0,Q.jsx)(`g`,{className:`kpc-header`,children:(0,Q.jsx)(`text`,{x:C.l,y:C.t-8,className:`kpc-title`,children:r})}),P.length===0?(0,Q.jsx)(`g`,{className:`kpc-empty`,children:(0,Q.jsx)(`text`,{x:C.l+Math.max(10,(f?T:t)-C.l-C.r)/2,y:C.t+Math.max(10,n-C.t-C.b)/2,textAnchor:`middle`,alignmentBaseline:`middle`,className:`kpc-axis-text`,children:`Waiting for Φ ticks…`})}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(`g`,{className:`kpc-grid`,children:[Array.from({length:ce+1}).map((e,t)=>{let n=H(R+t*(z-R)/Math.max(1,ce));return(0,Q.jsx)(`line`,{x1:n,x2:n,y1:C.t,y2:C.t+I,className:`kpc-gridline`},`x-${t}`)}),Array.from({length:Math.max(1,l)+1}).map((e,t)=>{let n=U(B+t*(V-B)/Math.max(1,l));return(0,Q.jsx)(`line`,{x1:C.l,x2:C.l+F,y1:n,y2:n,className:`kpc-gridline`},`y-${t}`)})]}),(0,Q.jsx)(`g`,{className:`kpc-bands`,children:(u?.length?u:De).map((e,t)=>{let n=U(B+e*(V-B));return(0,Q.jsx)(`line`,{x1:C.l,x2:C.l+F,y1:n,y2:n,className:`kpc-band`},`fb-${t}`)})}),d&&P.length>=3&&(0,Q.jsx)(`g`,{className:`kpc-vwap`,children:(0,Q.jsx)(`rect`,{x:C.l,width:F,y:U(se*1.015),height:Math.max(2,Math.abs(U(se*.985)-U(se*1.015))),fill:`url(#kpc-band)`,rx:`3`})}),de&&(0,Q.jsx)(`path`,{d:de,fill:`url(#kpc-fill)`,className:`kpc-area`}),G&&(0,Q.jsx)(`path`,{d:G,className:`kpc-line`,filter:`url(#kpc-glow)`}),(0,Q.jsxs)(`g`,{className:`kpc-axes`,children:[Array.from({length:ce+1}).map((e,t)=>{let n=R+t*(z-R)/Math.max(1,ce);return(0,Q.jsx)(`text`,{x:H(n),y:C.t+I+22,textAnchor:`middle`,className:`kpc-axis-text`,children:Math.floor(n)},`xl-${t}`)}),(0,Q.jsx)(`text`,{x:C.l,y:C.t+I+36,textAnchor:`start`,className:`kpc-axis-text`,children:`☤KAI`}),Array.from({length:Math.max(1,l)+1}).map((e,t)=>{let n=B+t*(V-B)/Math.max(1,l),r=U(n);return(0,Q.jsx)(`text`,{x:C.l-10,y:r+4,textAnchor:`end`,className:`kpc-axis-text`,children:o(n)},`yl-${t}`)})]}),q&&(0,Q.jsxs)(`g`,{className:`kpc-last-tag`,children:[(0,Q.jsx)(`circle`,{cx:H(q.p),cy:U(q.price),r:`4.5`,className:`kpc-dot`}),(0,Q.jsx)(`rect`,{x:C.l+F-158,y:U(q.price)-12,width:`150`,height:`24`,rx:`12`,className:`kpc-badge`}),(0,Q.jsxs)(`text`,{x:C.l+F-150,y:U(q.price)+5,className:`kpc-badge-text`,children:[o(q.price),` `,Y>=0?`▲`:`▼`,` `,Math.abs(he).toFixed(2),`%`]})]}),K&&X&&(0,Q.jsxs)(`g`,{className:`kpc-xhair`,children:[(0,Q.jsx)(`line`,{x1:K.x,x2:K.x,y1:C.t,y2:C.t+I,className:`kpc-xhair-line`}),(0,Q.jsx)(`line`,{x1:C.l,x2:C.l+F,y1:K.y,y2:K.y,className:`kpc-xhair-line`}),(0,Q.jsx)(`rect`,{x:X.x,y:X.y,width:X.w,height:X.h,rx:`8`,ry:`8`,className:`kpc-tip`}),(0,Q.jsxs)(`text`,{x:X.textX,y:X.textY,className:`kpc-tip-text`,children:[`☤KAI `,Math.floor(K.p),` • `,o(K.price)]})]})]})]})]})},Me=`https://pay.kaiklok.com`,Ne=`pk_live_51SNLMpRzKZKauLy5RLZFDy8FzHTt50YH1BRbXof1Db79yr1xchPQLzLF43pixjKLUbwKr2nc3WT6eq7TZZInfnhT00IMTw0M8N`,Pe=17491,Fe={ip:{expectedCashflowPhi:[]}},Ie=[],Le=[144,233,987],Re={position:`fixed`,left:-1e4,top:-1e4,width:1,height:1,opacity:0,visibility:`hidden`,pointerEvents:`none`,overflow:`hidden`,clipPath:`inset(50%)`,contain:`layout paint size style`};function ze(e,t=15e3){let n=new AbortController,r=setTimeout(()=>n.abort(),t);return e(n.signal).finally(()=>clearTimeout(r))}async function Be(e,t){return ze(async n=>{let r=await fetch(`${e}/api/payments/intent`,{method:`POST`,headers:{"Content-Type":`application/json`},credentials:`omit`,mode:`cors`,signal:n,body:JSON.stringify({amount:Math.max(1,Math.round(t)),currency:`usd`,description:`Kairos Sovereign Inhale`})});if(!r.ok){let e=await r.text().catch(()=>``)||`Failed to create payment intent (${r.status})`;throw Error(e)}return await r.json()})}function Ve(){return(0,Q.jsx)(`img`,{className:`hp-phi-icon`,src:`/phi.svg`,alt:`Φ`})}var He=()=>{let[e]=(0,c.useState)(Fe);return e},Ue=({amountUsd:e,intentId:t,onClose:n,onSuccess:r})=>{let i=_e(),a=pe(),[o,s]=(0,c.useState)(!1),[l,u]=(0,c.useState)(``),d=(0,c.useCallback)(async()=>{if(!(!i||!a||o)){s(!0),u(``);try{let{error:e,paymentIntent:t}=await i.confirmPayment({elements:a,redirect:`if_required`,confirmParams:{return_url:typeof window<`u`?window.location.href:void 0}});if(e){u(e.message||`Payment confirmation failed.`);return}if(t?.status===`succeeded`){r?.();return}u(`Payment is not complete yet. Please try again.`)}catch(e){u(e instanceof Error?e.message:`Unable to confirm payment.`)}finally{s(!1)}}},[i,a,o,r]);return(0,Q.jsxs)(`div`,{className:`hp-popover`,role:`dialog`,"aria-label":`Inline sovereign checkout`,"data-intent-id":t,children:[(0,Q.jsxs)(`div`,{className:`hp-pop-head`,children:[(0,Q.jsxs)(`div`,{className:`hp-pop-title`,children:[`Seal `,` `,e.toLocaleString(void 0,{style:`currency`,currency:`USD`}),`: To ΦKey`]}),(0,Q.jsx)(`button`,{type:`button`,className:`hp-x`,onClick:n,"aria-label":`Close checkout`,children:`×`})]}),(0,Q.jsxs)(`div`,{className:`hp-pop-body`,children:[(0,Q.jsx)(`div`,{className:`hp-payment`,"aria-busy":!a,children:(0,Q.jsx)(ve,{})}),(0,Q.jsxs)(`div`,{className:`hp-actions`,children:[(0,Q.jsx)(`button`,{type:`button`,className:`hp-primary`,onClick:d,disabled:o||!i||!a,children:o?`Confirming…`:`Mint Premium ΦKey `}),(0,Q.jsx)(`button`,{type:`button`,className:`hp-secondary`,onClick:n,children:`Cancel`})]}),l&&(0,Q.jsx)(`div`,{className:`hp-error`,children:l}),(0,Q.jsx)(`p`,{className:`hp-fine`,children:`3-D Secure via Stripe (PCI). No securities. No fiat ROI.`})]})]})};function We({ctaAmountUsd:e=250,apiBase:t=Me,title:r=`Value Index`,chartHeight:i=120,onError:a,stripePk:s=Ne,onExpandChange:l}){let u=He(),[d,f]=(0,c.useState)(e),[p,ee]=(0,c.useState)(!1),m=(0,c.useRef)(l);(0,c.useEffect)(()=>{m.current=l},[l]),(0,c.useEffect)(()=>{m.current?.(!1)},[]);let h=(0,c.useMemo)(()=>O(s),[s]),[g,_]=(0,c.useState)(null),[te,v]=(0,c.useState)(null),[y,b]=(0,c.useState)(0),[x,S]=(0,c.useState)(!1),[C,w]=(0,c.useState)(``),T=(0,c.useCallback)(e=>{let t=Math.max(1,Math.round(Number.isFinite(d)?d:1)),r=n({meta:u,nowPulse:Math.floor(e),usd:t,currentStreakDays:0,lifetimeUsdSoFar:0,plannedHoldBeats:0},o);return r.phiPerUsd>0?1/r.phiPerUsd:0},[u,d]),E=(0,c.useCallback)(e=>T(e),[T]),[D,k]=(0,c.useState)(null),A=(0,c.useCallback)(({p:e,price:t})=>{k({pulse:e,price:t})},[]),j=(0,c.useMemo)(()=>{if(!D)return null;let e=T(D.pulse-Pe);return e>0?(D.price-e)/e*100:0},[D,T]),M=!!(D&&Number.isFinite(D.price)&&D.price>0),N=M?`$${D.price.toFixed(2)} / Φ`:`—`,ne=M?(0,Q.jsxs)(`span`,{className:`hp-price-row`,"aria-label":N,children:[(0,Q.jsx)(`span`,{className:`hp-price-usd`,children:`$${D.price.toFixed(2)}`}),(0,Q.jsxs)(`span`,{className:`hp-price-slash`,"aria-hidden":!0,children:[` `,`/`,` `]}),(0,Q.jsx)(Ve,{})]}):`—`,re=(()=>j==null||!Number.isFinite(j)?`0.00%`:`${j>=0?`+`:`−`}${Math.abs(j).toFixed(2)}%`)(),ie=j!=null&&j>=0?`hp-up`:`hp-down`,P=(0,c.useCallback)(async()=>{w(``);try{let{clientSecret:n,intentId:r}=await Be(t,Number.isFinite(d)?Math.max(1,Math.round(d)):e);_(n),v(r),b(e=>e+1),S(!1)}catch(e){w(e instanceof Error?e.message:`Unable to start checkout.`),a?.(e)}},[d,e,t,a]),ae=(0,c.useCallback)(()=>{_(null),v(null),b(e=>e+1)},[]),F=(0,c.useCallback)(()=>{S(!0);try{let t={amount:Number.isFinite(d)?Math.max(1,Math.round(d)):e,method:`card`};typeof window<`u`&&window.dispatchEvent(new CustomEvent(`investor:contribution`,{detail:t}))}catch(e){a?.(e)}ae()},[d,e,a,ae]),I=(0,c.useId)(),oe=(0,c.useCallback)(()=>{ee(e=>{let t=!e;return m.current?.(t),t})},[]);return(0,Q.jsxs)(`div`,{className:`hp-card ${p?`is-expanded`:`is-collapsed`}`,role:`group`,"aria-label":`Sovereign asset`,children:[(0,Q.jsxs)(`div`,{className:`hp-ticker`,role:`button`,tabIndex:0,"aria-expanded":p,"aria-controls":I,onClick:oe,onKeyDown:e=>{(e.key===`Enter`||e.key===` `)&&(e.preventDefault(),oe())},children:[(0,Q.jsx)(`div`,{className:`hp-left`,children:(0,Q.jsx)(`span`,{className:`hp-title`,"aria-label":r,children:(0,Q.jsx)(`span`,{className:`hp-titleText`,children:r})})}),(0,Q.jsxs)(`div`,{className:`hp-right`,children:[(0,Q.jsx)(`span`,{className:`hp-price`,"aria-live":`polite`,"aria-label":N,children:ne}),(0,Q.jsxs)(`span`,{className:`hp-pct ${ie}`,"aria-live":`polite`,children:[j!=null&&j>=0?`▲`:`▼`,` `,re]})]})]}),(0,Q.jsx)(`div`,{className:`hp-chart-wrap`,"aria-hidden":!p,style:p?{marginTop:8}:Re,children:(0,Q.jsx)(`div`,{className:`hp-chart`,children:(0,Q.jsx)(je,{points:Ie,autoWidth:!0,height:i,title:void 0,priceFn:E,onTick:A,live:!0})})}),(0,Q.jsxs)(`div`,{id:I,className:`hp-expand ${p?`is-open`:`is-closed`}`,role:`region`,"aria-label":`Live chart and inhale controls`,style:p?{}:{height:0,overflow:`hidden`,visibility:`hidden`,pointerEvents:`none`},children:[(0,Q.jsxs)(`div`,{className:`hp-controls`,children:[(0,Q.jsxs)(`div`,{className:`hp-chips`,children:[(0,Q.jsx)(`span`,{className:`dim`,children:`Exhale:`}),Le.map(e=>(0,Q.jsxs)(`button`,{type:`button`,className:`chip ${e===d?`active`:``}`,onClick:t=>{t.stopPropagation(),f(e)},"aria-label":`Set sample to $${e}`,children:[`$`,e.toLocaleString()]},e)),(0,Q.jsx)(`button`,{type:`button`,className:`chip ghost`,"aria-label":`Increase sample by 5%`,onClick:e=>{e.stopPropagation(),f(e=>Math.max(1,Math.round(e*1.05)))},children:`+5%`})]}),(0,Q.jsx)(`div`,{className:`hp-actions-row`,children:(0,Q.jsx)(`button`,{type:`button`,className:`hp-primary`,onClick:e=>{e.stopPropagation(),P()},"aria-haspopup":`dialog`,children:`Premium ΦKey`})}),C&&(0,Q.jsx)(`div`,{className:`hp-error`,children:C})]}),g&&te&&(0,Q.jsx)(K,{stripe:h,options:{clientSecret:g,appearance:{theme:`night`,variables:{colorPrimary:`#37FFE4`,colorBackground:`rgba(8,14,16,.7)`,colorText:`#E8FBF8`,colorTextSecondary:`#AEE8DF`,colorIcon:`#E8FBF8`,borderRadius:`10px`},rules:{".Tab":{borderRadius:`10px`},".Input":{borderRadius:`10px`,backgroundColor:`rgba(255,255,255,0.06)`}}}},children:(0,Q.jsx)(Ue,{amountUsd:Number.isFinite(d)?Math.max(1,Math.round(d)):e,intentId:te,onClose:ae,onSuccess:F})},y),x&&(0,Q.jsxs)(`div`,{className:`hp-toast`,role:`status`,"aria-live":`polite`,children:[(0,Q.jsx)(`span`,{className:`hp-dot`,"aria-hidden":!0}),`Inhale sealed. Thank you, sovereign.`]})]})]})}export{We as default};