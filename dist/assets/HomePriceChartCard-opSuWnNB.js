import{An as e,bt as t,tn as n,wn as r,yt as i}from"./index-CEPP-mDI.js";import{t as a}from"./prop-types-BoOBHXq4.js";var o=e(r(),1),s=`clover`,c=function(e){return e===3?`v3`:e},l=`https://js.stripe.com`,u=`${l}/${s}/stripe.js`,d=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,f=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,p=`loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used`,ee=function(e){return d.test(e)||f.test(e)},m=function(){for(var e=document.querySelectorAll(`script[src^="${l}"]`),t=0;t<e.length;t++){var n=e[t];if(ee(n.src))return n}return null},h=function(e){var t=e&&!e.advancedFraudSignals?`?advancedFraudSignals=false`:``,n=document.createElement(`script`);n.src=`${u}${t}`;var r=document.head||document.body;if(!r)throw Error(`Expected document.body not to be null. Stripe.js requires a <body> element.`);return r.appendChild(n),n},g=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:`stripe-js`,version:`8.5.3`,startTime:t})},_=null,v=null,y=null,te=function(e){return function(t){e(Error(`Failed to load Stripe.js`,{cause:t}))}},b=function(e,t){return function(){window.Stripe?e(window.Stripe):t(Error(`Stripe.js not available`))}},x=function(e){return _===null?(_=new Promise(function(t,n){if(typeof window>`u`||typeof document>`u`){t(null);return}if(window.Stripe&&e&&console.warn(p),window.Stripe){t(window.Stripe);return}try{var r=m();if(r&&e)console.warn(p);else if(!r)r=h(e);else if(r&&y!==null&&v!==null){var i;r.removeEventListener(`load`,y),r.removeEventListener(`error`,v),(i=r.parentNode)==null||i.removeChild(r),r=h(e)}y=b(t,n),v=te(n),r.addEventListener(`load`,y),r.addEventListener(`error`,v)}catch(e){n(e);return}}),_.catch(function(e){return _=null,Promise.reject(e)})):_},S=function(e,t,n){if(e===null)return null;var r=t[0].match(/^pk_test/),i=c(e.version),a=s;r&&i!==a&&console.warn(`Stripe.js@${i} was loaded on the page, but @stripe/stripe-js@8.5.3 expected Stripe.js@${a}. This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning`);var o=e.apply(void 0,t);return g(o,n),o},C,w=!1,T=function(){return C||(C=x(null).catch(function(e){return C=null,Promise.reject(e)}),C)};Promise.resolve().then(function(){return T()}).catch(function(e){w||console.warn(e)});var E=function(){var e=[...arguments];w=!0;var t=Date.now();return T().then(function(n){return S(n,e,t)})},D=e(a(),1);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?O(Object(n),!0).forEach(function(t){j(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e){"@babel/helpers - typeof";return A=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},A(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function ne(e,t){if(e==null)return{};var n=M(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N(e,t){return re(e)||ie(e,t)||P(e,t)||F()}function re(e){if(Array.isArray(e))return e}function ie(e,t){var n=e&&(typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`]);if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(e){a=!0,s=e}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function P(e,t){if(e){if(typeof e==`string`)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}}function ae(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function F(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=function(e,t,n){var r=!!n,i=o.useRef(n);o.useEffect(function(){i.current=n},[n]),o.useEffect(function(){if(!r||!e)return function(){};var n=function(){i.current&&i.current.apply(i,arguments)};return e.on(t,n),function(){e.off(t,n)}},[r,t,e,i])},oe=function(e){var t=o.useRef(e);return o.useEffect(function(){t.current=e},[e]),t.current},L=function(e){return e!==null&&A(e)===`object`},R=function(e){return L(e)&&typeof e.then==`function`},z=function(e){return L(e)&&typeof e.elements==`function`&&typeof e.createToken==`function`&&typeof e.createPaymentMethod==`function`&&typeof e.confirmCardPayment==`function`},B=`[object Object]`,V=function e(t,n){if(!L(t)||!L(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var i=Object.prototype.toString.call(t)===B;if(i!==(Object.prototype.toString.call(n)===B))return!1;if(!i&&!r)return t===n;var a=Object.keys(t),o=Object.keys(n);if(a.length!==o.length)return!1;for(var s={},c=0;c<a.length;c+=1)s[a[c]]=!0;for(var l=0;l<o.length;l+=1)s[o[l]]=!0;var u=Object.keys(s);if(u.length!==a.length)return!1;var d=t,f=n;return u.every(function(t){return e(d[t],f[t])})},se=function(e,t,n){return L(e)?Object.keys(e).reduce(function(r,i){var a=!L(t)||!V(e[i],t[i]);return n.includes(i)?(a&&console.warn(`Unsupported prop change: options.${i} is not a mutable property.`),r):a?k(k({},r||{}),{},j({},i,e[i])):r},null):null},H="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",ce=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:H;if(e===null||z(e))return e;throw Error(t)},le=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:H;if(R(e))return{tag:`async`,stripePromise:Promise.resolve(e).then(function(e){return ce(e,t)})};var n=ce(e,t);return n===null?{tag:`empty`}:{tag:`sync`,stripe:n}},U=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:`react-stripe-js`,version:`5.4.1`}),e.registerAppInfo({name:`react-stripe-js`,version:`5.4.1`,url:`https://stripe.com/docs/stripe-js/react`}))},W=o.createContext(null);W.displayName=`ElementsContext`;var G=function(e,t){if(!e)throw Error(`Could not find Elements context; You need to wrap the part of your app that ${t} in an <Elements> provider.`);return e},K=function(e){var t=e.stripe,n=e.options,r=e.children,i=o.useMemo(function(){return le(t)},[t]),a=N(o.useState(function(){return{stripe:i.tag===`sync`?i.stripe:null,elements:i.tag===`sync`?i.stripe.elements(n):null}}),2),s=a[0],c=a[1];o.useEffect(function(){var e=!0,t=function(e){c(function(t){return t.stripe?t:{stripe:e,elements:e.elements(n)}})};return i.tag===`async`&&!s.stripe?i.stripePromise.then(function(n){n&&e&&t(n)}):i.tag===`sync`&&!s.stripe&&t(i.stripe),function(){e=!1}},[i,s,n]);var l=oe(t);o.useEffect(function(){l!==null&&l!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[l,t]);var u=oe(n);return o.useEffect(function(){if(s.elements){var e=se(n,u,[`clientSecret`,`fonts`]);e&&s.elements.update(e)}},[n,u,s.elements]),o.useEffect(function(){U(s.stripe)},[s.stripe]),o.createElement(W.Provider,{value:s},r)};K.propTypes={stripe:D.default.any,options:D.default.object};var ue=function(e){return G(o.useContext(W),e)},q=function(){return ue(`calls useElements()`).elements},de=function(e){var t=e.children;return t(ue(`mounts <ElementsConsumer>`))};de.propTypes={children:D.default.func.isRequired};var fe=o.createContext(null);fe.displayName=`CheckoutContext`,D.default.any,D.default.shape({clientSecret:D.default.oneOfType([D.default.string,D.default.instanceOf(Promise)]).isRequired,elementsOptions:D.default.object}).isRequired;var pe=function(e){var t=o.useContext(fe),n=o.useContext(W);if(t){if(n)throw Error(`You cannot wrap the part of your app that ${e} in both <CheckoutProvider> and <Elements> providers.`);return t}else return G(n,e)},J=[`mode`],me=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Y=function(e,t){var n=`${me(e)}Element`,r=t?function(e){pe(`mounts <${n}>`);var t=e.id,r=e.className;return o.createElement(`div`,{id:t,className:r})}:function(t){var r=t.id,i=t.className,a=t.options,s=a===void 0?{}:a,c=t.onBlur,l=t.onFocus,u=t.onReady,d=t.onChange,f=t.onEscape,p=t.onClick,ee=t.onLoadError,m=t.onLoaderStart,h=t.onNetworksChange,g=t.onConfirm,_=t.onCancel,v=t.onShippingAddressChange,y=t.onShippingRateChange,te=t.onSavedPaymentMethodRemove,b=t.onSavedPaymentMethodUpdate,x=pe(`mounts <${n}>`),S=`elements`in x?x.elements:null,C=`checkoutState`in x?x.checkoutState:null,w=C?.type===`success`||C?.type===`loading`?C.sdk:null,T=N(o.useState(null),2),E=T[0],D=T[1],O=o.useRef(null),k=o.useRef(null);I(E,`blur`,c),I(E,`focus`,l),I(E,`escape`,f),I(E,`click`,p),I(E,`loaderror`,ee),I(E,`loaderstart`,m),I(E,`networkschange`,h),I(E,`confirm`,g),I(E,`cancel`,_),I(E,`shippingaddresschange`,v),I(E,`shippingratechange`,y),I(E,`savedpaymentmethodremove`,te),I(E,`savedpaymentmethodupdate`,b),I(E,`change`,d);var A;u&&(A=e===`expressCheckout`?u:function(){u(E)}),I(E,`ready`,A),o.useLayoutEffect(function(){if(O.current===null&&k.current!==null&&(S||w)){var t=null;if(w)switch(e){case`paymentForm`:t=w.createPaymentFormElement();break;case`payment`:t=w.createPaymentElement(s);break;case`address`:if(`mode`in s){var r=s.mode,i=ne(s,J);if(r===`shipping`)t=w.createShippingAddressElement(i);else if(r===`billing`)t=w.createBillingAddressElement(i);else throw Error(`Invalid options.mode. mode must be 'billing' or 'shipping'.`)}else throw Error(`You must supply options.mode. mode must be 'billing' or 'shipping'.`);break;case`expressCheckout`:t=w.createExpressCheckoutElement(s);break;case`currencySelector`:t=w.createCurrencySelectorElement();break;case`taxId`:t=w.createTaxIdElement(s);break;default:throw Error(`Invalid Element type ${n}. You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />.`)}else S&&(t=S.create(e,s));O.current=t,D(t),t&&t.mount(k.current)}},[S,w,s]);var j=oe(s);return o.useEffect(function(){if(O.current){var e=se(s,j,[`paymentRequest`]);e&&`update`in O.current&&O.current.update(e)}},[s,j]),o.useLayoutEffect(function(){return function(){if(O.current&&typeof O.current.destroy==`function`)try{O.current.destroy(),O.current=null}catch{}}},[]),o.createElement(`div`,{id:r,className:i,ref:k})};return r.propTypes={id:D.default.string,className:D.default.string,onChange:D.default.func,onBlur:D.default.func,onFocus:D.default.func,onReady:D.default.func,onEscape:D.default.func,onClick:D.default.func,onLoadError:D.default.func,onLoaderStart:D.default.func,onNetworksChange:D.default.func,onConfirm:D.default.func,onCancel:D.default.func,onShippingAddressChange:D.default.func,onShippingRateChange:D.default.func,onSavedPaymentMethodRemove:D.default.func,onSavedPaymentMethodUpdate:D.default.func,options:D.default.object},r.displayName=n,r.__elementType=e,r},X=typeof window>`u`,Z=o.createContext(null);Z.displayName=`EmbeddedCheckoutProviderContext`;var he=function(){return pe(`calls useStripe()`).stripe};Y(`auBankAccount`,X),Y(`card`,X),Y(`cardNumber`,X),Y(`cardExpiry`,X),Y(`cardCvc`,X),Y(`iban`,X);var ge=Y(`payment`,X);Y(`expressCheckout`,X),Y(`paymentRequestButton`,X),Y(`linkAuthentication`,X),Y(`address`,X),Y(`shippingAddress`,X),Y(`paymentMethodMessaging`,X),Y(`taxId`,X);var Q=e(n(),1),_e=1715323541888,ve=(3+Math.sqrt(5))*1e3,ye=()=>(Date.now()-_e)/ve,$=(e,t,n)=>Math.max(t,Math.min(n,e)),be=e=>Math.round(e*100)/100,xe=e=>e.toLocaleString(`en-US`,{style:`currency`,currency:`USD`,minimumFractionDigits:2,maximumFractionDigits:2}),Se=(e,t)=>{let n=(1+Math.sqrt(5))/2,r=Math.sin(2*Math.PI*e/44)*.85,i=Math.sin(2*Math.PI*n*e)*.42,a=Math.sin(2*Math.PI*(n-1)*e)*.28,o=Math.sin(e*.1618)*.35;return be(t+r+i+a+o)},Ce=e=>$(.35+.65*Math.abs(Math.sin(2*Math.PI*e/11)),0,1),we=Object.freeze([]),Te=Object.freeze([]),Ee=`
.kai-price-wrap { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji"; color: #e7fbf7; }
.kai-price-chart { display:block; width:100%; height:auto; }
.kpc-title { fill:#a2bbb6; font-size:12px; font-weight:600; letter-spacing:0.4px; }
.kpc-gridline { stroke:#ffffff22; stroke-width:1; shape-rendering:crispEdges; }
.kpc-band { stroke:#81fff133; stroke-width:1; stroke-dasharray:4 4; }
.kpc-line { fill:none; stroke:#37e6d4; stroke-width:2.25; }
.kpc-area { opacity:1; }
.kpc-axes .kpc-axis-text { fill:#a2bbb6; font-size:11px; dominant-baseline:middle; }
.kpc-dot { fill:#37e6d4; stroke:#0a0f12; stroke-width:2; }
.kpc-badge { fill:#0a0f12cc; stroke:#ffffff22; stroke-width:1; }
.kpc-badge-text { fill:#e7fbf7; font-size:11px; font-weight:600; }
.kpc-xhair-line { stroke:#ffffff33; stroke-width:1; shape-rendering:crispEdges; }
.kpc-tip { fill:#0a0f12f2; stroke:#ffffff22; }
.kpc-tip-text { fill:#e7fbf7; font-size:11px; font-weight:600; }
.kpc-header text { user-select:none; }
.kpc-ticker { display:flex; align-items:center; gap:10px; margin-bottom:6px; font-size:12px; color:#a2bbb6; }
.kpc-live-dot { width:8px; height:8px; border-radius:9999px; background:#28c76f; box-shadow:0 0 0 6px #28c76f22; }
.kpc-live { font-weight:700; letter-spacing:0.08em; color:#a2bbb6; }
.kpc-last { font-weight:700; color:#e7fbf7; }
.kpc-last.up { color:#c1ffe9; }
.kpc-last.down { color:#ffd1d1; }
.kpc-delta.up { color:#28c76f; }
.kpc-delta.down { color:#ff4d4f; }
.kpc-pulse { color:#a2bbb6; }
.kpc-empty { display:flex; align-items:center; justify-content:center; color:#a2bbb6; height:100%; font-size:12px; }
`,De={l:64,r:20,t:28,b:36},Oe=e=>globalThis[e],ke=(e,t,n,r)=>{let i=Math.floor(t),a=Math.floor(n),o=Math.max(String(i).length,String(a).length,1)*7+18,s=$(Math.ceil(o+14),56,140),c=Math.max(1,Math.floor(e/s));return $(Math.min(r,c),1,Math.max(1,r))},Ae=({points:e,width:t=720,height:n=280,title:r=`Φ Value — Live (☤Kai)`,className:i,style:a,formatter:s=xe,gridXTicks:c=6,gridYTicks:l=4,bandLevels:u=[.236,.382,.5,.618],showVWAP:d=!0,autoWidth:f=!1,includeStyles:p=!0,onHoverPoint:ee,live:m=!0,windowPoints:h=240,priceFn:g,volFn:_,tickAlignToPulse:v=!0,tickMs:y=ve,fetchSigilMeta:te,buildExchangeSeries:b,issuancePolicy:x,onTick:S})=>{let C=De,w=o.useRef(null),[T,E]=o.useState(t),D=o.useRef(te??Oe(`fetchSigilMeta`)),O=o.useRef(b??Oe(`buildExchangeSeries`)),k=o.useRef(x??Oe(`DEFAULT_ISSUANCE_POLICY`));o.useEffect(()=>{D.current=te??Oe(`fetchSigilMeta`)},[te]),o.useEffect(()=>{O.current=b??Oe(`buildExchangeSeries`)},[b]),o.useEffect(()=>{k.current=x??Oe(`DEFAULT_ISSUANCE_POLICY`)},[x]);let[A,j]=o.useState([]),M=o.useRef(null),ne=o.useRef(null),[N,re]=o.useState(null);o.useLayoutEffect(()=>{if(!w.current)return;let e=w.current,n=()=>{let n=Math.floor(e.getBoundingClientRect().width||t);n>0&&E(n)};if(n(),typeof ResizeObserver>`u`)return;let r=new ResizeObserver(()=>n());return r.observe(e),()=>r.disconnect()},[t]),o.useEffect(()=>{let e=!0,t=D.current;return t&&t().then(t=>{e&&re(t)}).catch(()=>{}),()=>{e=!1}},[]);let ie=o.useCallback((e,t)=>{if(g)return{price:be(Math.max(1e-4,g(e))),vol:_?$(_(e),0,1):Ce(e)};let n=O.current,r=k.current;if(N&&typeof n==`function`&&r)try{let t=Math.max(0,e-11),i=n({meta:N,usdSample:100},r,t,e,11),a=i?.[i.length-1];if(a&&typeof a.usdPerPhi==`number`){let e=a.choirActive||a.festivalActive?.5:.25;return{price:be(Math.max(1e-4,a.usdPerPhi)),vol:e}}}catch{}let i=t??1.618,a=Math.max(1e-4,Se(e,i)),o=Ce(e);return{price:be(a),vol:o}},[N,g,_]);o.useEffect(()=>{if(!m)return;let t=ye(),n=Math.floor(t),r=n-(Math.max(2,h)-1),i=e??we,a=[],o=i.length>0?i[i.length-1].price:null;for(let e=r;e<=n;e++){let{price:t,vol:n}=ie(e,o);a.push({p:e,price:t,vol:n}),o=t}if(j(a),M.current=n,ne.current=a.length>0?a[a.length-1].price:null,S&&a.length>0){let e=a[a.length-1];S({p:e.p,price:e.price})}},[m,h,ie,N,S,e]),o.useEffect(()=>{if(!m)return;let e,t=()=>{let e=ye(),t=Math.floor(e);if(M.current==null||t>M.current){let e=ne.current,n=ie(t,e);j(e=>{let r=[...e,{p:t,price:n.price,vol:n.vol}];return r.length>h?r.slice(r.length-h):r}),M.current=t,ne.current=n.price,S&&S({p:t,price:n.price})}n()},n=()=>{if(v){let n=ye(),r=n-Math.floor(n),i=Math.max(1,(1-r)*ve);e=window.setTimeout(t,i+2)}else e=window.setTimeout(t,y)};return n(),()=>{e&&window.clearTimeout(e)}},[m,h,ie,v,y,S]);let P=o.useMemo(()=>m?A:e??we,[m,A,e]),ae=f?T:t,F=Math.max(10,ae-C.l-C.r),I=Math.max(10,n-C.t-C.b),oe=Math.max(10,T||t),L=Math.max(10,oe-C.l-C.r),{minX:R,maxX:z,minY:B,maxY:V,vwap:se}=o.useMemo(()=>{if(P.length===0)return{minX:0,maxX:1,minY:1,maxY:2,vwap:0};let e=P.map(e=>e.p),t=P.map(e=>e.price),n=P.map(e=>e.vol??0),r=Math.min(...e),i=Math.max(...e),a=Math.min(...t),o=Math.max(...t),s=n.reduce((e,t)=>e+t,0)||1,c=P.reduce((e,t)=>e+t.price*(t.vol??0),0)/s,l=(o-a)*.12||.5;return{minX:r,maxX:i,minY:Math.max(0,a-l),maxY:o+l,vwap:c}},[P]),H=o.useMemo(()=>ke(L,R,z,Math.max(1,c)),[L,R,z,c]),ce=o.useCallback(e=>z===R?0:(e-R)/(z-R),[R,z]),le=o.useCallback(e=>V===B?1:1-(e-B)/(V-B),[B,V]),U=o.useCallback(e=>ce(e)*F+C.l,[ce,F,C.l]),W=o.useCallback(e=>le(e)*I+C.t,[le,I,C.t]),G=o.useMemo(()=>P.map(e=>({x:U(e.p),y:W(e.price)})),[P,U,W]),K=o.useMemo(()=>{if(G.length<2)return``;let e=(e,t,n,r)=>{let i=.5;return{c1x:t.x+(n.x-e.x)*i/6,c1y:t.y+(n.y-e.y)*i/6,c2x:n.x-(r.x-t.x)*i/6,c2y:n.y-(r.y-t.y)*i/6}},t=`M${G[0].x.toFixed(2)} ${G[0].y.toFixed(2)}`;for(let n=0;n<G.length-1;n++){let r=G[n-1]||G[n],i=G[n],a=G[n+1],{c1x:o,c1y:s,c2x:c,c2y:l}=e(r,i,a,G[n+2]||a);t+=` C${o.toFixed(2)} ${s.toFixed(2)}, ${c.toFixed(2)} ${l.toFixed(2)}, ${a.x.toFixed(2)} ${a.y.toFixed(2)}`}return t},[G]),ue=o.useMemo(()=>{if(!K||G.length===0)return``;let e=C.t+I,t=G[G.length-1],n=G[0];return`${K} L${t.x.toFixed(2)} ${e.toFixed(2)} L${n.x.toFixed(2)} ${e.toFixed(2)} Z`},[K,G,I,C.t]),[q,de]=o.useState(null),fe=e=>{let t=e.currentTarget.getBoundingClientRect(),n=R+($(e.clientX-t.left,C.l,C.l+F)-C.l)/F*(z-R);if(P.length===0){de(null),ee?.(null);return}let r=P[0],i=Math.abs(r.p-n);for(let e of P){let t=Math.abs(e.p-n);t<i&&(i=t,r=e)}de({x:U(r.p),y:W(r.price),p:r.p,price:r.price}),ee?.({p:r.p,price:r.price})},pe=()=>{de(null),ee?.(null)},J=P.length>0?P[P.length-1]:void 0,me=P.length>1?P[P.length-2]:void 0,Y=J&&me?be(J.price-me.price):0,X=J&&me&&me.price!==0?Y/me.price*100:0,Z=o.useMemo(()=>{if(!q)return null;let e=C.l,t=C.l+F,n=C.t,r=C.t+I,i=q.x+10;i+184>t&&(i=q.x-10-184);let a=e+6,o=Math.max(a,t-184-6);i=$(i,a,o);let s=q.y-22;s<n+6&&(s=q.y+10);let c=n+6,l=Math.max(c,r-36-6);return s=$(s,c,l),{x:i,y:s,w:184,h:36,textX:i+8,textY:s+20}},[q,F,I,C.l,C.t]);return(0,Q.jsxs)(`div`,{ref:w,className:`kai-price-wrap ${i??``}`,style:a,children:[p&&(0,Q.jsx)(`style`,{dangerouslySetInnerHTML:{__html:Ee}}),(0,Q.jsxs)(`div`,{className:`kpc-ticker`,"aria-live":`polite`,children:[(0,Q.jsx)(`div`,{className:`kpc-live-dot`,"aria-hidden":!0}),(0,Q.jsx)(`div`,{className:`kpc-live`,children:`LIVE`}),(0,Q.jsx)(`div`,{className:`kpc-last ${Y>=0?`up`:`down`}`,children:J?s(J.price):`—`}),(0,Q.jsxs)(`div`,{className:`kpc-delta ${Y>=0?`up`:`down`}`,children:[Y>=0?`▲`:`▼`,` `,s(Math.abs(Y)),` (`,X>=0?`+`:``,X.toFixed(2),`%)`]}),J&&(0,Q.jsxs)(`div`,{className:`kpc-pulse`,children:[`☤KAI `,Math.floor(J.p)]})]}),(0,Q.jsxs)(`svg`,{width:f?T:t,height:n,className:`kai-price-chart`,onMouseMove:fe,onMouseLeave:pe,role:`img`,"aria-label":`Live Φ value in fiat over ☤KAI Pulses`,children:[(0,Q.jsxs)(`defs`,{children:[(0,Q.jsxs)(`filter`,{id:`kpc-glow`,x:`-50%`,y:`-50%`,width:`200%`,height:`200%`,children:[(0,Q.jsx)(`feGaussianBlur`,{stdDeviation:`4`,result:`coloredBlur`}),(0,Q.jsxs)(`feMerge`,{children:[(0,Q.jsx)(`feMergeNode`,{in:`coloredBlur`}),(0,Q.jsx)(`feMergeNode`,{in:`SourceGraphic`})]})]}),(0,Q.jsxs)(`linearGradient`,{id:`kpc-fill`,x1:`0`,y1:`0`,x2:`0`,y2:`1`,children:[(0,Q.jsx)(`stop`,{offset:`0%`,stopColor:`rgba(55,255,228,0.28)`}),(0,Q.jsx)(`stop`,{offset:`100%`,stopColor:`rgba(55,255,228,0.00)`})]}),(0,Q.jsxs)(`linearGradient`,{id:`kpc-band`,x1:`0`,y1:`0`,x2:`0`,y2:`1`,children:[(0,Q.jsx)(`stop`,{offset:`0%`,stopColor:`rgba(167,139,250,0.12)`}),(0,Q.jsx)(`stop`,{offset:`100%`,stopColor:`rgba(55,255,228,0.12)`})]})]}),(0,Q.jsx)(`g`,{className:`kpc-header`,children:(0,Q.jsx)(`text`,{x:C.l,y:C.t-8,className:`kpc-title`,children:r})}),P.length===0?(0,Q.jsx)(`g`,{className:`kpc-empty`,children:(0,Q.jsx)(`text`,{x:C.l+Math.max(10,(f?T:t)-C.l-C.r)/2,y:C.t+Math.max(10,n-C.t-C.b)+2,textAnchor:`middle`,alignmentBaseline:`middle`,className:`kpc-axis-text`,children:`Waiting for Φ ticks…`})}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(`g`,{className:`kpc-grid`,children:[Array.from({length:H+1}).map((e,t)=>{let n=U(R+t*(z-R)/Math.max(1,H));return(0,Q.jsx)(`line`,{x1:n,x2:n,y1:C.t,y2:C.t+I,className:`kpc-gridline`},`x-${t}`)}),Array.from({length:Math.max(1,l)+1}).map((e,t)=>{let n=W(B+t*(V-B)/Math.max(1,l));return(0,Q.jsx)(`line`,{x1:C.l,x2:C.l+F,y1:n,y2:n,className:`kpc-gridline`},`y-${t}`)})]}),(0,Q.jsx)(`g`,{className:`kpc-bands`,children:(u?.length?u:Te).map((e,t)=>{let n=W(B+e*(V-B));return(0,Q.jsx)(`line`,{x1:C.l,x2:C.l+F,y1:n,y2:n,className:`kpc-band`},`fb-${t}`)})}),d&&P.length>=3&&(0,Q.jsx)(`g`,{className:`kpc-vwap`,children:(0,Q.jsx)(`rect`,{x:C.l,width:F,y:W(se*1.015),height:Math.max(2,Math.abs(W(se*.985)-W(se*1.015))),fill:`url(#kpc-band)`,rx:`3`})}),ue&&(0,Q.jsx)(`path`,{d:ue,fill:`url(#kpc-fill)`,className:`kpc-area`}),K&&(0,Q.jsx)(`path`,{d:K,className:`kpc-line`,filter:`url(#kpc-glow)`}),(0,Q.jsxs)(`g`,{className:`kpc-axes`,children:[Array.from({length:H+1}).map((e,t)=>{let n=R+t*(z-R)/Math.max(1,H);return(0,Q.jsx)(`text`,{x:U(n),y:C.t+I+22,textAnchor:`middle`,className:`kpc-axis-text`,children:Math.floor(n)},`xl-${t}`)}),(0,Q.jsx)(`text`,{x:C.l,y:C.t+I+36,textAnchor:`start`,className:`kpc-axis-text`,children:`☤KAI`}),Array.from({length:Math.max(1,l)+1}).map((e,t)=>{let n=B+t*(V-B)/Math.max(1,l),r=W(n);return(0,Q.jsx)(`text`,{x:C.l-10,y:r+4,textAnchor:`end`,className:`kpc-axis-text`,children:s(n)},`yl-${t}`)})]}),J&&(0,Q.jsxs)(`g`,{className:`kpc-last-tag`,children:[(0,Q.jsx)(`circle`,{cx:U(J.p),cy:W(J.price),r:`4.5`,className:`kpc-dot`}),(0,Q.jsx)(`rect`,{x:C.l+F-158,y:W(J.price)-12,width:`150`,height:`24`,rx:`12`,className:`kpc-badge`}),(0,Q.jsxs)(`text`,{x:C.l+F-150,y:W(J.price)+5,className:`kpc-badge-text`,children:[s(J.price),` `,Y>=0?`▲`:`▼`,` `,Math.abs(X).toFixed(2),`%`]})]}),q&&Z&&(0,Q.jsxs)(`g`,{className:`kpc-xhair`,children:[(0,Q.jsx)(`line`,{x1:q.x,x2:q.x,y1:C.t,y2:C.t+I,className:`kpc-xhair-line`}),(0,Q.jsx)(`line`,{x1:C.l,x2:C.l+F,y1:q.y,y2:q.y,className:`kpc-xhair-line`}),(0,Q.jsx)(`rect`,{x:Z.x,y:Z.y,width:Z.w,height:Z.h,rx:`8`,ry:`8`,className:`kpc-tip`}),(0,Q.jsxs)(`text`,{x:Z.textX,y:Z.textY,className:`kpc-tip-text`,children:[`☤KAI `,Math.floor(q.p),` • `,s(q.price)]})]})]})]})]})},je=`https://pay.kaiklok.com`,Me=`pk_live_51SNLMpRzKZKauLy5RLZFDy8FzHTt50YH1BRbXof1Db79yr1xchPQLzLF43pixjKLUbwKr2nc3WT6eq7TZZInfnhT00IMTw0M8N`,Ne=17491,Pe={ip:{expectedCashflowPhi:[]}},Fe=[],Ie=[144,233,987],Le={position:`fixed`,left:-1e4,top:-1e4,width:1,height:1,opacity:0,visibility:`hidden`,pointerEvents:`none`,overflow:`hidden`,clipPath:`inset(50%)`,contain:`layout paint size style`};function Re(e,t=15e3){let n=new AbortController,r=setTimeout(()=>n.abort(),t);return e(n.signal).finally(()=>clearTimeout(r))}async function ze(e,t){return Re(async n=>{let r=await fetch(`${e}/api/payments/intent`,{method:`POST`,headers:{"Content-Type":`application/json`},credentials:`omit`,mode:`cors`,signal:n,body:JSON.stringify({amount:Math.max(1,Math.round(t)),currency:`usd`,description:`Kairos Sovereign Inhale`})});if(!r.ok){let e=await r.text().catch(()=>``)||`Failed to create payment intent (${r.status})`;throw Error(e)}return await r.json()})}function Be(){return(0,Q.jsx)(`img`,{className:`hp-phi-icon`,src:`/phi.svg`,alt:`Φ`})}var Ve=()=>{let[e]=(0,o.useState)(Pe);return e},He=({amountUsd:e,intentId:t,onClose:n,onSuccess:r})=>{let i=he(),a=q(),[s,c]=(0,o.useState)(!1),[l,u]=(0,o.useState)(``),d=(0,o.useCallback)(async()=>{if(!(!i||!a||s)){c(!0),u(``);try{let{error:e,paymentIntent:t}=await i.confirmPayment({elements:a,redirect:`if_required`,confirmParams:{return_url:typeof window<`u`?window.location.href:void 0}});if(e){u(e.message||`Payment confirmation failed.`);return}if(t?.status===`succeeded`){r?.();return}u(`Payment is not complete yet. Please try again.`)}catch(e){u(e instanceof Error?e.message:`Unable to confirm payment.`)}finally{c(!1)}}},[i,a,s,r]);return(0,Q.jsxs)(`div`,{className:`hp-popover`,role:`dialog`,"aria-label":`Inline sovereign checkout`,"data-intent-id":t,children:[(0,Q.jsxs)(`div`,{className:`hp-pop-head`,children:[(0,Q.jsxs)(`div`,{className:`hp-pop-title`,children:[`Seal `,` `,e.toLocaleString(void 0,{style:`currency`,currency:`USD`}),`: To ΦKey`]}),(0,Q.jsx)(`button`,{type:`button`,className:`hp-x`,onClick:n,"aria-label":`Close checkout`,children:`×`})]}),(0,Q.jsxs)(`div`,{className:`hp-pop-body`,children:[(0,Q.jsx)(`div`,{className:`hp-payment`,"aria-busy":!a,children:(0,Q.jsx)(ge,{})}),(0,Q.jsxs)(`div`,{className:`hp-actions`,children:[(0,Q.jsx)(`button`,{type:`button`,className:`hp-primary`,onClick:d,disabled:s||!i||!a,children:s?`Confirming…`:`Mint Premium ΦKey `}),(0,Q.jsx)(`button`,{type:`button`,className:`hp-secondary`,onClick:n,children:`Cancel`})]}),l&&(0,Q.jsx)(`div`,{className:`hp-error`,children:l}),(0,Q.jsx)(`p`,{className:`hp-fine`,children:`3-D Secure via Stripe (PCI). No securities. No fiat ROI.`})]})]})};function Ue({ctaAmountUsd:e=250,apiBase:n=je,title:r=`Value Index`,chartHeight:a=120,onError:s,stripePk:c=Me,onExpandChange:l}){let u=Ve(),[d,f]=(0,o.useState)(e),[p,ee]=(0,o.useState)(!1),m=(0,o.useRef)(l);(0,o.useEffect)(()=>{m.current=l},[l]),(0,o.useEffect)(()=>{m.current?.(!1)},[]);let h=(0,o.useMemo)(()=>E(c),[c]),[g,_]=(0,o.useState)(null),[v,y]=(0,o.useState)(null),[te,b]=(0,o.useState)(0),[x,S]=(0,o.useState)(!1),[C,w]=(0,o.useState)(``),T=(0,o.useCallback)(e=>{let n=Math.max(1,Math.round(Number.isFinite(d)?d:1)),r=t({meta:u,nowPulse:Math.floor(e),usd:n,currentStreakDays:0,lifetimeUsdSoFar:0,plannedHoldBeats:0},i);return r.phiPerUsd>0?1/r.phiPerUsd:0},[u,d]),D=(0,o.useCallback)(e=>T(e),[T]),[O,k]=(0,o.useState)(null),A=(0,o.useCallback)(({p:e,price:t})=>{k({pulse:e,price:t})},[]),j=(0,o.useMemo)(()=>{if(!O)return null;let e=T(O.pulse-Ne);return e>0?(O.price-e)/e*100:0},[O,T]),M=!!(O&&Number.isFinite(O.price)&&O.price>0),ne=M?`$${O.price.toFixed(2)} / Φ`:`—`,N=M?(0,Q.jsxs)(`span`,{className:`hp-price-row`,"aria-label":ne,children:[(0,Q.jsx)(`span`,{className:`hp-price-usd`,children:`$${O.price.toFixed(2)}`}),(0,Q.jsxs)(`span`,{className:`hp-price-slash`,"aria-hidden":!0,children:[` `,`/`,` `]}),(0,Q.jsx)(Be,{})]}):`—`,re=(()=>j==null||!Number.isFinite(j)?`0.00%`:`${j>=0?`+`:`−`}${Math.abs(j).toFixed(2)}%`)(),ie=j!=null&&j>=0?`hp-up`:`hp-down`,P=(0,o.useCallback)(async()=>{w(``);try{let{clientSecret:t,intentId:r}=await ze(n,Number.isFinite(d)?Math.max(1,Math.round(d)):e);_(t),y(r),b(e=>e+1),S(!1)}catch(e){w(e instanceof Error?e.message:`Unable to start checkout.`),s?.(e)}},[d,e,n,s]),ae=(0,o.useCallback)(()=>{_(null),y(null),b(e=>e+1)},[]),F=(0,o.useCallback)(()=>{S(!0);try{let t={amount:Number.isFinite(d)?Math.max(1,Math.round(d)):e,method:`card`};typeof window<`u`&&window.dispatchEvent(new CustomEvent(`investor:contribution`,{detail:t}))}catch(e){s?.(e)}ae()},[d,e,s,ae]),I=(0,o.useId)(),oe=(0,o.useCallback)(()=>{ee(e=>{let t=!e;return m.current?.(t),t})},[]);return(0,Q.jsxs)(`div`,{className:`hp-card ${p?`is-expanded`:`is-collapsed`}`,role:`group`,"aria-label":`Sovereign asset`,children:[(0,Q.jsxs)(`div`,{className:`hp-ticker`,role:`button`,tabIndex:0,"aria-expanded":p,"aria-controls":I,onClick:oe,onKeyDown:e=>{(e.key===`Enter`||e.key===` `)&&(e.preventDefault(),oe())},children:[(0,Q.jsx)(`div`,{className:`hp-left`,children:(0,Q.jsx)(`span`,{className:`hp-title`,"aria-label":r,children:(0,Q.jsx)(`span`,{className:`hp-titleText`,children:r})})}),(0,Q.jsxs)(`div`,{className:`hp-right`,children:[(0,Q.jsx)(`span`,{className:`hp-price`,"aria-live":`polite`,"aria-label":ne,children:N}),(0,Q.jsxs)(`span`,{className:`hp-pct ${ie}`,"aria-live":`polite`,children:[j!=null&&j>=0?`▲`:`▼`,` `,re]})]})]}),(0,Q.jsx)(`div`,{className:`hp-chart-wrap`,"aria-hidden":!p,style:p?{marginTop:8}:Le,children:(0,Q.jsx)(`div`,{className:`hp-chart`,children:(0,Q.jsx)(Ae,{points:Fe,autoWidth:!0,height:a,title:void 0,priceFn:D,onTick:A,live:!0})})}),(0,Q.jsxs)(`div`,{id:I,className:`hp-expand ${p?`is-open`:`is-closed`}`,role:`region`,"aria-label":`Live chart and inhale controls`,style:p?{}:{height:0,overflow:`hidden`,visibility:`hidden`,pointerEvents:`none`},children:[(0,Q.jsxs)(`div`,{className:`hp-controls`,children:[(0,Q.jsxs)(`div`,{className:`hp-chips`,children:[(0,Q.jsx)(`span`,{className:`dim`,children:`Exhale:`}),Ie.map(e=>(0,Q.jsxs)(`button`,{type:`button`,className:`chip ${e===d?`active`:``}`,onClick:t=>{t.stopPropagation(),f(e)},"aria-label":`Set sample to $${e}`,children:[`$`,e.toLocaleString()]},e)),(0,Q.jsx)(`button`,{type:`button`,className:`chip ghost`,"aria-label":`Increase sample by 5%`,onClick:e=>{e.stopPropagation(),f(e=>Math.max(1,Math.round(e*1.05)))},children:`+5%`})]}),(0,Q.jsx)(`div`,{className:`hp-actions-row`,children:(0,Q.jsx)(`button`,{type:`button`,className:`hp-primary`,onClick:e=>{e.stopPropagation(),P()},"aria-haspopup":`dialog`,children:`Premium ΦKey`})}),C&&(0,Q.jsx)(`div`,{className:`hp-error`,children:C})]}),g&&v&&(0,Q.jsx)(K,{stripe:h,options:{clientSecret:g,appearance:{theme:`night`,variables:{colorPrimary:`#37FFE4`,colorBackground:`rgba(8,14,16,.7)`,colorText:`#E8FBF8`,colorTextSecondary:`#AEE8DF`,colorIcon:`#E8FBF8`,borderRadius:`10px`},rules:{".Tab":{borderRadius:`10px`},".Input":{borderRadius:`10px`,backgroundColor:`rgba(255,255,255,0.06)`}}}},children:(0,Q.jsx)(He,{amountUsd:Number.isFinite(d)?Math.max(1,Math.round(d)):e,intentId:v,onClose:ae,onSuccess:F})},te),x&&(0,Q.jsxs)(`div`,{className:`hp-toast`,role:`status`,"aria-live":`polite`,children:[(0,Q.jsx)(`span`,{className:`hp-dot`,"aria-hidden":!0}),`Inhale sealed. Thank you, sovereign.`]})]})]})}export{Ue as default};