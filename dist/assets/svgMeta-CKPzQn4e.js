import{ln as e,sn as t}from"./index-D8u_mC6U.js";function n(e){return Math.max(0,Math.floor(e))*11}function r(e){return Math.max(0,Math.floor(e))}function i(e,t){let n=11*t,r=(e%n+n)%n;return Math.floor(r/11)}var a=`http://www.w3.org/2000/svg`,o=`http://www.w3.org/1999/xlink`;function s(e){if(typeof e!=`string`||e.trim()===``)return e;let t=e.replace(/<script[\s\S]*?<\/script>/gi,``);return t=t.replace(/\son[a-z]+\s*=\s*"[^"]*"/gi,``),t=t.replace(/\son[a-z]+\s*=\s*'[^']*'/gi,``),t=t.replace(/\son[a-z]+\s*=\s*[^\s>'"]+/gi,``),t=t.replace(/\s(?:xlink:)?href\s*=\s*"(?:https?:)?\/\/[^"]*"/gi,``),t=t.replace(/\s(?:xlink:)?href\s*=\s*'(?:https?:)?\/\/[^']*'/gi,``),t=t.replace(/<foreignObject[\s\S]*?<\/foreignObject>/gi,``),t}function c(e){let t=s(e),n=new DOMParser().parseFromString(t,`image/svg+xml`).documentElement;if(!n||n.nodeName.toLowerCase()!==`svg`)throw Error(`Invalid SVG`);let r=n.querySelector(`metadata`),i={};if(r&&r.textContent)try{i=JSON.parse(r.textContent)}catch{i={}}return{svg:n,meta:i}}function l(e){e.getAttribute(`xmlns`)||e.setAttribute(`xmlns`,a),e.getAttribute(`xmlns:xlink`)||e.setAttribute(`xmlns:xlink`,o)}function u(e){let t=e.ownerDocument??document,n=e.querySelector(`metadata`);if(n)return n;let r=t.createElementNS(a,`metadata`);return e.insertBefore(r,e.firstChild),r}function d(e,t,n){let r=e.ownerDocument??document,i=e.querySelector(`title`);i||(i=r.createElementNS(a,`title`),e.insertBefore(i,e.firstChild)),i.textContent=t;let o=e.querySelector(`desc`);o||(o=r.createElementNS(a,`desc`),e.insertBefore(o,i.nextSibling)),o.textContent=n}function f(e,t){if(!e.getAttribute(`viewBox`))try{let n=e.viewBox.baseVal;if(n?.width&&n?.height)e.setAttribute(`viewBox`,`${n.x} ${n.y} ${n.width} ${n.height}`);else if(typeof e.getBBox==`function`){let n=e.getBBox();n?.width&&n?.height?e.setAttribute(`viewBox`,`${n.x} ${n.y} ${n.width} ${n.height}`):e.setAttribute(`viewBox`,`0 0 ${t} ${t}`)}else e.setAttribute(`viewBox`,`0 0 ${t} ${t}`)}catch{e.setAttribute(`viewBox`,`0 0 ${t} ${t}`)}e.setAttribute(`width`,String(t)),e.setAttribute(`height`,String(t)),e.setAttribute(`preserveAspectRatio`,`xMidYMid meet`)}function p(e,t){let n=u(e);n.textContent=JSON.stringify(t),l(e);let r=new XMLSerializer().serializeToString(e);return r.startsWith(`<?xml`)?r:`<?xml version="1.0" encoding="UTF-8"?>\n${r}`}var m=e=>typeof e==`number`&&Number.isFinite(e),h=(e,t=0)=>{if(m(e))return e;if(typeof e==`string`&&e.trim()!==``){let n=Number(e);return Number.isFinite(n)?n:t}return t};function g(e){let t=[];if(e.pulse??t.push(`Missing metadata field: pulse`),e.beat??t.push(`Missing metadata field: beat`),e.chakraDay??t.push(`Missing metadata field: chakraDay`),t.length>0)return{ok:!1,errors:t};let n=Number.isFinite(e.stepsPerBeat)?Math.max(1,Number(e.stepsPerBeat)):44,r=Number(e.pulse),a=Number(e.stepIndex),o=Number.isFinite(a)&&a>=0&&a<n?Math.trunc(a):i(r,n),s=typeof e.stepPct==`number`?Math.max(0,Math.min(1,e.stepPct)):(o+1e-9)/n,c=h(e.expiresAtPulse,NaN),l=h(e.exportedAtPulse,NaN),u=typeof e.claimExtendUnit==`string`?String(e.claimExtendUnit).toLowerCase():``,d=u===`steps`?`steps`:u===`breaths`?`breaths`:void 0,f=e.claimExtendAmount!=null&&Number.isFinite(Number(e.claimExtendAmount))?Math.max(0,Math.floor(Number(e.claimExtendAmount))):void 0;return{ok:!0,errors:[],normalized:{pulse:r,beat:Number(e.beat),stepIndex:o,stepPct:s,chakraDay:e.chakraDay,kaiSignature:typeof e.kaiSignature==`string`?e.kaiSignature:void 0,userPhiKey:typeof e.userPhiKey==`string`?e.userPhiKey:void 0,stepsPerBeat:n,provenance:Array.isArray(e.provenance)?e.provenance:void 0,attachment:typeof e.attachment==`object`?e.attachment:void 0,expiresAtPulse:Number.isFinite(c)?c:void 0,canonicalHash:typeof e.canonicalHash==`string`?e.canonicalHash:void 0,transferNonce:typeof e.transferNonce==`string`?e.transferNonce:void 0,exportedAtPulse:Number.isFinite(l)?l:void 0,claimExtendUnit:d,claimExtendAmount:f,zkPoseidonHash:``,zkProof:{pi_a:[``,``,``],pi_b:[[``,``],[``,``],[``,``]],pi_c:[``,``,``]},ownerPubKey:{},ownerSig:``,originalAmount:0,debits:[],totalDebited:0,lineageRoot:null,eternalRecord:``,creatorResolved:``,origin:``,proofHints:{scheme:``,api:``,explorer:``}}}}function _(e,t){try{let{svg:n,meta:r}=c(e),i=!!n.getAttribute(`xmlns`)&&!!n.getAttribute(`xmlns:xlink`),a=!!n.getAttribute(`viewBox`),o=!!n.getAttribute(`width`)&&!!n.getAttribute(`height`),{ok:s,errors:l,normalized:u}=g(r);return i||l.push(`Missing xmlns / xmlns:xlink on <svg>.`),a||l.push(`Missing viewBox on <svg>.`),o||l.push(`Missing width/height on <svg>.`),t&&u?.canonicalHash&&u.canonicalHash!==t&&l.push(`canonicalHash in Î¦key metadata does not match the live glyph hash.`),{ok:l.length===0&&s,errors:l,payload:u??null,meta:r}}catch(e){return{ok:!1,errors:[e instanceof Error&&e.message?e.message:`Invalid SVG`],payload:null,meta:null}}}const v={SVG_NS:a,XLINK_NS:o};export{l as a,s as c,r as d,i as f,f as i,g as l,u as n,c as o,n as p,d as r,p as s,v as t,_ as u};